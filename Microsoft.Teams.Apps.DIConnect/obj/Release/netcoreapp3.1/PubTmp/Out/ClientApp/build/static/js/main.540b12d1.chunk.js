(this["webpackJsonpdi-connect"]=this["webpackJsonpdi-connect"]||[]).push([[0],{326:function(e,t,a){},418:function(e,t,a){},419:function(e,t,a){},421:function(e,t,a){},483:function(e,t,a){},484:function(e,t,a){},627:function(e,t,a){},628:function(e,t,a){},629:function(e,t,a){},695:function(e,t,a){},696:function(e,t,a){},699:function(e,t,a){},700:function(e,t,a){},701:function(e,t,a){},702:function(e,t,a){},703:function(e,t,a){},704:function(e,t,a){},708:function(e,t,a){},711:function(e,t,a){"use strict";a.r(t);var s=a(2),n=a(0),r=a.n(n),i=a(65),c=a.n(i),o=(a(483),a(23)),l=a(25),u=a(29),d=a(28),p=a(450),h=a(50),m=a(16),g=a(161),j=a(81),b=a(88),f=a(762),x=(a(484),function(){return window.location.origin}),O=function e(){Object(o.a)(this,e)};O.stateTagMaxLength=20,O.stateTagMaxCount=3,O.stateLocationMaxLength=100,O.maxLengthName=100,O.maxLengthDescription=300,O.maxLengthKnowledgeBaseId=50,O.groupCreatedBotCommand="Group created",O.editTaskModuleHeight=800,O.editTaskModuleWidth=600,O.faqSettingsTaskModuleHeight=200,O.faqSettingsTaskModuleWidth=350,O.screenWidth=750,O.entityId="DI_connect_app";var v=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.updateTabSettings=function(e){0===e.selectedIndex?(s.setState({tabName:s.localize("CommunicationsTabName"),url:x()+"/messages?locale={locale}"}),m.settings.setValidityState(!0)):1===e.selectedIndex&&(s.setState({tabName:s.localize("ConfigurationTabName"),url:x()+"/configurationTab?locale={locale}"}),m.settings.setValidityState(!0))},s.localize=s.props.t,s.state={url:"",tabName:""},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.settings.registerOnSaveHandler((function(t){m.settings.setSettings({entityId:O.entityId,contentUrl:e.state.url,suggestedDisplayName:e.state.tabName}),t.notifySuccess()})),m.settings.setValidityState(!1)}},{key:"render",value:function(){var e=this;return Object(s.jsx)("div",{className:"config-container",children:Object(s.jsx)(g.a,{selectable:!0,onSelectedIndexChange:function(t,a){e.updateTabSettings(a)},items:[{key:"communication",media:Object(s.jsx)(j.a,{className:"img-container",src:x()+"/artifacts/color.png",avatar:!0}),content:Object(s.jsx)(b.a,{className:"text-container",content:this.localize("CommunicationsTabOption")})},{key:"configuration",media:Object(s.jsx)(j.a,{className:"img-container",src:x()+"/artifacts/color.png",avatar:!0}),content:Object(s.jsx)(b.a,{className:"text-container",content:this.localize("ConfigurationTabOption")})}]})})}}]),a}(r.a.Component),k=Object(f.a)()(v),S=a(175),C=a(91),y=a(84),T=a(785),L=a(154),w=a(765),N=a(715),z=a(766),I=a(82),E=a(8),M=a.n(E),D=a(12),G=a(254),P=a(211),A=a(436),F=a(127),R=a.n(F);a(600);G.a.use(A.a).use(P.e).init({fallbackLng:"en-US",interpolation:{escapeValue:!1}});var U=function(e){return e?R()(e).format("l LT"):e},B=function(e,t){var a="";if(e&&t){var s=R()(t).diff(R()(e)),n=R.a.duration(s);a=("0"+Math.floor(n.asHours())).slice(-2)+R.a.utc(n.asMilliseconds()).locale("en-US").format(":mm:ss")}return a},q=function(e){var t=window.location.search,a=new URLSearchParams(t).get("locale")||"en-US";return Number(e).toLocaleString(a)},_=G.a,V=a(148),W=a.n(V),H=new(function(){function e(){Object(o.a)(this,e)}return Object(l.a)(e,[{key:"get",value:function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s,n,r=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!(r.length>1&&void 0!==r[1])||r[1],s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=3,!s){e.next=8;break}return e.next=7,this.setupAuthorizationHeader(n);case 7:n=e.sent;case 8:return e.next=10,W.a.get(t,n);case 10:return e.abrupt("return",e.sent);case 13:if(e.prev=13,e.t0=e.catch(3),!a){e.next=20;break}throw this.handleError(e.t0),e.t0;case 20:throw e.t0;case 21:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"patch",value:function(){var e=Object(D.a)(M.a.mark((function e(t,a){var s,n,r=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(n);case 5:return n=e.sent,e.next=8,W.a.patch(t,a,n);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!s){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s,n=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=!(n.length>1&&void 0!==n[1])||n[1],s=n.length>2?n[2]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(s);case 5:return s=e.sent,e.next=8,W.a.delete(t,s);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!a){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=Object(D.a)(M.a.mark((function e(t,a){var s,n,r=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(n);case 5:return n=e.sent,e.next=8,W.a.post(t,a,n);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!s){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"put",value:function(){var e=Object(D.a)(M.a.mark((function e(t,a){var s,n,r=arguments;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=!(r.length>2&&void 0!==r[2])||r[2],n=r.length>3?r[3]:void 0,e.prev=2,e.next=5,this.setupAuthorizationHeader(n);case 5:return n=e.sent,e.next=8,W.a.put(t,a,n);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!s){e.next=18;break}throw this.handleError(e.t0),e.t0;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t,a){return e.apply(this,arguments)}}()},{key:"handleError",value:function(e){if(e.hasOwnProperty("response")){var t=e.response.status;window.location.href=403===t?"/errorpage/403?locale=".concat(_.language):401===t?"/errorpage/401?locale=".concat(_.language):"/errorpage?locale=".concat(_.language)}else window.location.href="/errorpage?locale=".concat(_.language)}},{key:"setupAuthorizationHeader",value:function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.initialize(),e.abrupt("return",new Promise((function(e,a){var s={successCallback:function(a){t||(t=W.a.defaults),t.headers.Authorization="Bearer ".concat(a),t.headers["Accept-Language"]=_.language,e(t)},failureCallback:function(e){console.error("Error from getAuthToken: ",e),window.location.href="/signin?locale=".concat(_.language)},resources:[]};m.authentication.getAuthToken(s)})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}()),K=x()+"/api",Q=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=K+"/sentnotifications",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=K+"/draftnotifications",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=K+"/groupdata/verifyaccess",e.next=3,H.get(t,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),$=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/groupdata/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Y=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/groupdata/search/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/exportnotification/"+t,e.next=3,H.put(a,null,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/sentnotifications/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications/"+t,e.next=3,H.delete(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),se=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications/duplicates/"+t,e.next=3,H.post(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ne=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/sentnotifications",e.next=3,H.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications",e.next=3,H.put(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ie=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications",e.next=3,H.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=K+"/teamdata",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications/consentSummaries/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),le=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=K+"/draftnotifications/previews",e.next=3,H.post(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ue=function(){var e=Object(D.a)(M.a.mark((function e(t,a){var s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s="".concat(K,"/authenticationMetadata/consentUrl?windowLocationOriginDomain=").concat(t,"&loginhint=").concat(a),e.next=3,H.get(s,void 0,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),de=function(e){return{type:"MESSAGE_SELECTED",payload:e}},pe=function(){return function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q();case 2:a=e.sent,(s=a.data).forEach((function(e){e.sendingStartedDate=U(e.sendingStartedDate),e.sentDate=U(e.sentDate)})),t({type:"FETCH_MESSAGES",payload:s});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},he=function(){return function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J();case 2:a=e.sent,t({type:"FETCH_DRAFTMESSAGES",payload:a.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},me=a(763),ge=a(95),je=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.onOpenTaskModule=function(e,t,a){var s={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(s,(function(e,t){}))},s.duplicateDraftMessage=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.localize=s.props.t,s.state={menuOpen:!1},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){m.initialize()}},{key:"render",value:function(){var e=this,t=[{key:"more",icon:Object(s.jsx)(me.a,{outline:!0}),menuOpen:this.state.menuOpen,active:this.state.menuOpen,indicator:!1,menu:{items:[{key:"status",content:this.localize("ViewStatus"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=x()+"/viewstatus/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("ViewStatus"))}},{key:"duplicate",content:this.localize("Duplicate"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.duplicateDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}}]},onMenuOpenChange:function(t,a){a.menuOpen;e.setState({menuOpen:!e.state.menuOpen})}}];return Object(s.jsx)(ge.a,{className:"menuContainer",iconOnly:!0,items:t,styles:this.props.styles,title:this.props.title})}}]),a}(r.a.Component),be=Object(f.a)()(je),fe=Object(y.b)((function(e){return{messagesList:e.messagesList}}),{selectMessage:de,getMessagesList:pe,getDraftMessagesList:he})(be),xe=(a(627),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.interval=void 0,n.isOpenTaskModuleAllowed=void 0,n.processLabels=function(){return[{key:"labels",content:Object(s.jsxs)(L.a,{vAlign:"center",fill:!0,gap:"gap.small",children:[Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1,children:Object(s.jsx)(b.a,{truncated:!0,weight:"bold",content:n.localize("TitleText")})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(s.jsx)(b.a,{})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1,children:Object(s.jsx)(b.a,{truncated:!0,content:n.localize("Recipients"),weight:"bold"})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(s.jsx)(b.a,{truncated:!0,content:n.localize("Sent"),weight:"bold"})}),Object(s.jsx)(L.a.Item,{shrink:0,children:Object(s.jsx)(fe,{title:""})})]}),styles:{margin:"0.2rem 0.2rem 0 0"}}]},n.renderSendingText=function(e){var t="";switch(e.status){case"Queued":t=n.localize("Queued");break;case"SyncingRecipients":t=n.localize("SyncingRecipients");break;case"InstallingApp":t=n.localize("InstallingApp");break;case"Sending":var a=(e.succeeded?e.succeeded:0)+(e.failed?e.failed:0)+(e.unknown?e.unknown:0);t=n.localize("SendingMessages",{SentCount:q(a),TotalCount:q(e.totalMessageCount)});break;case"Sent":case"Failed":t=""}return Object(s.jsx)(b.a,{truncated:!0,content:t})},n.messageContent=function(e){return Object(s.jsxs)(L.a,{className:"listContainer",vAlign:"center",fill:!0,gap:"gap.small",children:[Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},grow:1,children:Object(s.jsx)(b.a,{truncated:!0,content:e.title})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:n.renderSendingText(e)}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},shrink:!1,children:Object(s.jsxs)("div",{children:[Object(s.jsxs)(T.a,{content:n.props.t("TooltipSuccess"),calloutProps:{gapSpace:0},children:[Object(s.jsx)(w.a,{xSpacing:"after",className:"succeeded",outline:!0}),Object(s.jsx)("span",{className:"semiBold",children:q(e.succeeded)})]}),Object(s.jsxs)(T.a,{content:n.props.t("TooltipFailure"),calloutProps:{gapSpace:0},children:[Object(s.jsx)(N.a,{xSpacing:"both",className:"failed",outline:!0}),Object(s.jsx)("span",{className:"semiBold",children:q(e.failed)})]}),e.unknown&&Object(s.jsxs)(T.a,{content:"Unknown",calloutProps:{gapSpace:0},children:[Object(s.jsx)(z.a,{xSpacing:"both",className:"unknown",outline:!0}),Object(s.jsx)("span",{className:"semiBold",children:q(e.unknown)})]})]})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"24%"},children:Object(s.jsx)(b.a,{truncated:!0,className:"semiBold",content:e.sentDate})}),Object(s.jsx)(L.a.Item,{shrink:0,children:Object(s.jsx)(fe,{message:e,title:""})})]})},n.escFunction=function(e){27!==e.keyCode&&"Escape"!==e.key||m.tasks.submitTask()},n.onOpenTaskModule=function(e,t,a){if(n.isOpenTaskModuleAllowed){n.isOpenTaskModuleAllowed=!1;var s={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(s,(function(e,t){n.isOpenTaskModuleAllowed=!0}))}},n.localize=n.props.t,n.isOpenTaskModuleAllowed=!0,n.state={message:n.props.messagesList,loader:!0},n.escFunction=n.escFunction.bind(Object(S.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),this.props.getMessagesList(),document.addEventListener("keydown",this.escFunction,!1),this.interval=setInterval((function(){e.props.getMessagesList()}),6e4)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1),clearInterval(this.interval)}},{key:"componentWillReceiveProps",value:function(e){this.props!==e&&this.setState({message:e.messagesList,loader:!1})}},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),n=this.state.message.map((function(a){return{key:++t,content:e.messageContent(a),onClick:function(){var t=x()+"/viewstatus/"+a.id+"?locale={locale}";e.onOpenTaskModule(null,t,e.localize("ViewStatus"))},styles:{margin:"0.2rem 0.2rem 0 0"}}})),r=[].concat(Object(C.a)(a),Object(C.a)(n));return this.state.loader?Object(s.jsx)(I.a,{}):0===this.state.message.length?Object(s.jsx)("div",{className:"results",children:this.localize("EmptySentMessages")}):Object(s.jsx)(g.a,{selectable:!0,items:r,className:"list"})}}]),a}(n.Component)),Oe=Object(f.a)()(xe),ve=Object(y.b)((function(e){return{messagesList:e.messagesList}}),{selectMessage:de,getMessagesList:pe,getDraftMessagesList:he})(Oe),ke=a(453),Se=(a(628),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.onOpenTaskModule=function(e,t,a){var n={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(n,(function(e,t){s.props.getDraftMessagesList().then((function(){s.props.getMessagesList()}))}))},s.duplicateDraftMessage=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,se(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.deleteDraftMessage=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ae(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.localize=s.props.t,s.state={teamsChannelId:"",teamsTeamId:"",menuOpen:!1},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){e.setState({teamsTeamId:t.teamId,teamsChannelId:t.channelId})}))}},{key:"render",value:function(){var e=this,t=[{key:"more",icon:Object(s.jsx)(me.a,{outline:!0}),menuOpen:this.state.menuOpen,active:this.state.menuOpen,indicator:!1,menu:{items:[{key:"send",content:this.localize("Send"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=x()+"/sendconfirmation/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("SendConfirmation"))}},{key:"preview",content:this.localize("PreviewInThisChannel"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a={draftNotificationId:e.props.message.id,teamsTeamId:e.state.teamsTeamId,teamsChannelId:e.state.teamsChannelId};le(a).then((function(e){return e.status})).catch((function(e){return e}))}},{key:"edit",content:this.localize("Edit"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1});var a=x()+"/newmessage/"+e.props.message.id+"?locale={locale}";e.onOpenTaskModule(null,a,e.localize("EditMessage"))}},{key:"duplicate",content:this.localize("Duplicate"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.duplicateDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}},{key:"delete",content:this.localize("Delete"),onClick:function(t){t.stopPropagation(),e.setState({menuOpen:!1}),e.deleteDraftMessage(e.props.message.id).then((function(){e.props.getDraftMessagesList()}))}}]},onMenuOpenChange:function(t,a){a.menuOpen;e.setState({menuOpen:!e.state.menuOpen})}}];return Object(s.jsx)(ge.a,{className:"menuContainer",iconOnly:!0,items:t,styles:this.props.styles,title:this.props.title})}}]),a}(r.a.Component)),Ce=Object(f.a)()(Se),ye=Object(y.b)((function(e){return{messages:e.draftMessagesList,selectedMessage:e.selectedMessage}}),{selectMessage:de,getDraftMessagesList:he,getMessagesList:pe})(Ce),Te=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.interval=void 0,n.isOpenTaskModuleAllowed=void 0,n.processLabels=function(){return[{key:"labels",content:Object(s.jsx)(L.a,{vAlign:"center",fill:!0,gap:"gap.small",children:Object(s.jsx)(L.a.Item,{children:Object(s.jsx)(b.a,{truncated:!0,weight:"bold",content:n.localize("TitleText")})})}),styles:{margin:"0.2rem 0.2rem 0 0"}}]},n.onOpenTaskModule=function(e,t,a){if(n.isOpenTaskModuleAllowed){n.isOpenTaskModuleAllowed=!1;var s={url:t,title:a,height:530,width:1e3,fallbackUrl:t};m.tasks.startTask(s,(function(e,t){n.props.getDraftMessagesList().then((function(){n.props.getMessagesList(),n.isOpenTaskModuleAllowed=!0}))}))}},Object(ke.a)(),n.localize=n.props.t,n.isOpenTaskModuleAllowed=!0,n.state={message:e.messages,itemsAccount:n.props.messages.length,loader:!0,teamsTeamId:"",teamsChannelId:""},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){e.setState({teamsTeamId:t.teamId,teamsChannelId:t.channelId})})),this.props.getDraftMessagesList(),this.interval=setInterval((function(){e.props.getDraftMessagesList()}),6e4)}},{key:"componentWillReceiveProps",value:function(e){this.setState({message:e.messages,loader:!1})}},{key:"componentWillUnmount",value:function(){clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),n=this.state.message.map((function(a){return{key:++t,content:Object(s.jsxs)(L.a,{vAlign:"center",fill:!0,gap:"gap.small",children:[Object(s.jsx)(L.a.Item,{shrink:0,grow:1,children:Object(s.jsx)(b.a,{children:a.title})}),Object(s.jsx)(L.a.Item,{shrink:0,align:"end",children:Object(s.jsx)(ye,{message:a,title:""})})]}),styles:{margin:"0.2rem 0.2rem 0 0"},onClick:function(){var t=x()+"/newmessage/"+a.id+"?locale={locale}";e.onOpenTaskModule(null,t,e.localize("EditMessage"))}}})),r=[].concat(Object(C.a)(a),Object(C.a)(n));return this.state.loader?Object(s.jsx)(I.a,{}):0===this.state.message.length?Object(s.jsx)("div",{className:"results",children:this.localize("EmptyDraftMessages")}):Object(s.jsx)(g.a,{selectable:!0,items:r,className:"list"})}}]),a}(n.Component),Le=Object(f.a)()(Te),we=Object(y.b)((function(e){return{messages:e.draftMessagesList,selectedMessage:e.selectedMessage}}),{selectMessage:de,getDraftMessagesList:he,getMessagesList:pe})(Le),Ne=(a(629),a(69)),ze=a(234),Ie=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.onNewMessage=function(){var e={url:s.state.url,title:s.localize("NewCommunicationCardTitle"),height:530,width:1e3,fallbackUrl:s.state.url};m.tasks.startTask(e,(function(e,t){s.props.getDraftMessagesList()}))},s.localize=s.props.t,s.state={url:x()+"/newmessage?locale={locale}"},s.escFunction=s.escFunction.bind(Object(S.a)(s)),s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){m.initialize(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"escFunction",value:function(e){27!==e.keyCode&&"Escape"!==e.key||m.tasks.submitTask()}},{key:"render",value:function(){var e=[{title:this.localize("DraftMessagesSectionTitle"),content:{key:"sent",content:Object(s.jsx)("div",{className:"messages",children:Object(s.jsx)(we,{})})}},{title:this.localize("SentMessagesSectionTitle"),content:{key:"draft",content:Object(s.jsx)("div",{className:"messages",children:Object(s.jsx)(ve,{})})}}];return Object(s.jsxs)("div",{className:"tabContainer",children:[Object(s.jsx)("div",{className:"newPostBtn",children:Object(s.jsx)(Ne.a,{content:this.localize("NewMessage"),onClick:this.onNewMessage,primary:!0})}),Object(s.jsx)("div",{className:"messageContainer",children:Object(s.jsx)(ze.a,{defaultActiveIndex:[0,1],panels:e})})]})}}]),a}(n.Component),Ee=Object(f.a)()(Ie),Me=Object(y.b)((function(e){return{messages:e.draftMessagesList}}),{getDraftMessagesList:he})(Ee),De=a(60),Ge=a(146),Pe=a(163),Ae=a(768),Fe=(a(695),a(696),function(e){return{type:"AdaptiveCard",body:[{type:"TextBlock",weight:"Bolder",text:e("TitleText"),size:"ExtraLarge",wrap:!0},{type:"Image",spacing:"Default",url:"",size:"Stretch",width:"400px",altText:""},{type:"TextBlock",text:"",wrap:!0},{type:"TextBlock",wrap:!0,size:"Small",weight:"Lighter",text:""}],$schema:"http://adaptivecards.io/schemas/adaptive-card.json",version:"1.0"}}),Re=function(e,t){e.body[0].text=t},Ue=function(e,t){e.body[1].url=t},Be=function(e,t){e.body[2].text=t},qe=function(e,t){e.body[3].text=t},_e=function(e,t,a){t&&a?e.actions=[{type:"Action.OpenUrl",title:t,url:a}]:delete e.actions},Ve=a(442),We=a.n(Ve),He=function e(){Object(o.a)(this,e)};He.makeInitialImage=function(e){var t=document.createElement("canvas");t.style.display="none",t.width=32,t.height=32,document.body.appendChild(t);var a=t.getContext("2d");if(a){var s=(new We.a).hex(e);a.fillStyle=s,a.fillRect(0,0,t.width,t.height),a.font="16px Arial",a.fillStyle="#fff";var n=e.split(" "),r=n.length,i=n[0][0];if(r>1){var c=i+n[r-1][0];a.fillText(c.toUpperCase(),3,23)}else a.fillText(i.toUpperCase(),10,23);var o=t.toDataURL();return document.body.removeChild(t),o}return""};var Ke=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.card=void 0,s.history=void 0,s.makeDropdownItems=function(e){var t=[];return e&&e.map((function(e){t.push({key:e.id,header:e.name,content:e.mail,image:He.makeInitialImage(e.name),team:{id:e.id}})})),t},s.makeDropdownItemList=function(e,t){var a=[];return e.map((function(e){return a.push("string"!==typeof e?e:{key:t.find((function(t){return t.id===e})).id,header:t.find((function(t){return t.id===e})).name,image:He.makeInitialImage(t.find((function(t){return t.id===e})).name),team:{id:e}})})),a},s.setDefaultCard=function(e){var t=s.localize("TitleText"),a=s.localize("Summary"),n=s.localize("Author1"),r=s.localize("ButtonTitle");Re(e,t);var i=x()+"/image/imagePlaceholder.png";Ue(e,i),Be(e,a),qe(e,n),_e(e,r,"https://adaptivecards.io")},s.getTeamList=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ce();case 3:t=e.sent,s.setState({teams:t.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),s.setGroupAccess=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X().then((function(){s.setState({groupAccess:!0})})).catch((function(e){if(403!==e.response.status)throw e;s.setState({groupAccess:!1})}));case 2:case"end":return e.stop()}}),e)}))),s.getGroupData=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,$(t);case 3:a=e.sent,s.setState({groups:a.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),s.getItem=function(){var e=Object(D.a)(M.a.mark((function e(t){var a,n,r;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:a=e.sent,n=a.data,r="teams",n.rosters.length>0?r="rosters":n.groups.length>0?r="groups":n.allUsers&&(r="allUsers"),s.setState({teamsOptionSelected:n.teams.length>0,selectedTeamsNum:n.teams.length,rostersOptionSelected:n.rosters.length>0,selectedRostersNum:n.rosters.length,groupsOptionSelected:n.groups.length>0,selectedGroupsNum:n.groups.length,selectedRadioBtn:r,selectedTeams:n.teams,selectedRosters:n.rosters,selectedGroups:n.groups}),Re(s.card,n.title),Ue(s.card,n.imageLink),Be(s.card,n.summary),qe(s.card,n.author),_e(s.card,n.buttonTitle,n.buttonLink),s.setState({title:n.title,summary:n.summary,btnLink:n.buttonLink,imageLink:n.imageLink,btnTitle:n.buttonTitle,author:n.author,allUsersOptionSelected:n.allUsers,loader:!1},(function(){s.updateCard()})),e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(t){return e.apply(this,arguments)}}(),s.onGroupSelected=function(e){s.setState({selectedRadioBtn:e,teamsOptionSelected:"teams"===e,rostersOptionSelected:"rosters"===e,groupsOptionSelected:"groups"===e,allUsersOptionSelected:"allUsers"===e,selectedTeams:"teams"===e?s.state.selectedTeams:[],selectedTeamsNum:"teams"===e?s.state.selectedTeamsNum:0,selectedRosters:"rosters"===e?s.state.selectedRosters:[],selectedRostersNum:"rosters"===e?s.state.selectedRostersNum:0,selectedGroups:"groups"===e?s.state.selectedGroups:[],selectedGroupsNum:"groups"===e?s.state.selectedGroupsNum:0})},s.isBtnDisabled=function(){var e=s.state.teamsOptionSelected&&0!==s.state.selectedTeamsNum||!s.state.teamsOptionSelected,t=s.state.rostersOptionSelected&&0!==s.state.selectedRostersNum||!s.state.rostersOptionSelected,a=s.state.groupsOptionSelected&&0!==s.state.selectedGroupsNum||!s.state.groupsOptionSelected,n=!s.state.teamsOptionSelected&&!s.state.rostersOptionSelected&&!s.state.groupsOptionSelected&&!s.state.allUsersOptionSelected;return!e||!t||!a||n},s.isNextBtnDisabled=function(){var e=s.state.title,t=s.state.btnTitle,a=s.state.btnLink;return!(e&&(t&&a||!t&&!a)&&""===s.state.errorImageUrlMessage&&""===s.state.errorButtonUrlMessage)},s.getItems=function(){var e=[];if(s.state.teams){var t=s.state.teams;"allUsers"!==s.state.selectedRadioBtn&&("teams"===s.state.selectedRadioBtn?s.state.teams.filter((function(e){return s.state.selectedTeams.findIndex((function(t){return t.team.id===e.id}))<0})):"rosters"===s.state.selectedRadioBtn&&s.state.teams.filter((function(e){return s.state.selectedRosters.findIndex((function(t){return t.team.id===e.id}))<0}))),t.map((function(t){e.push({key:t.id,header:t.name,content:t.mail,image:He.makeInitialImage(t.name),team:{id:t.id}})}))}return e},s.onTeamsChange=function(e,t){t.value.length>a.MAX_SELECTED_TEAMS_NUM||s.setState({selectedTeams:t.value,selectedTeamsNum:t.value.length,selectedRosters:[],selectedRostersNum:0,selectedGroups:[],selectedGroupsNum:0})},s.onRostersChange=function(e,t){t.value.length>a.MAX_SELECTED_TEAMS_NUM||s.setState({selectedRosters:t.value,selectedRostersNum:t.value.length,selectedTeams:[],selectedTeamsNum:0,selectedGroups:[],selectedGroupsNum:0})},s.onGroupsChange=function(e,t){s.setState({selectedGroups:t.value,selectedGroupsNum:t.value.length,groups:[],selectedTeams:[],selectedTeamsNum:0,selectedRosters:[],selectedRostersNum:0})},s.onGroupSearch=function(e,t){return e.filter((function(e){return e.header&&-1!==e.header.toLowerCase().indexOf(t.toLowerCase())||e.content&&-1!==e.content.toLowerCase().indexOf(t.toLowerCase())}))},s.onGroupSearchQueryChange=function(){var e=Object(D.a)(M.a.mark((function e(t,a){var n,r;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.searchQuery){e.next=4;break}s.setState({groups:[],noResultMessage:""}),e.next=24;break;case 4:if(!(a.searchQuery&&a.searchQuery.length<=2)){e.next=8;break}s.setState({loading:!1,noResultMessage:s.localize("NoResultMessage")}),e.next=24;break;case 8:if(!(a.searchQuery&&a.searchQuery.length>2)){e.next=24;break}if(!(a.items&&a.items.find((function(e){return e.header.toLowerCase()===a.searchQuery.toLowerCase()})))){e.next=12;break}return e.abrupt("return");case 12:return s.setState({loading:!0,noResultMessage:""}),e.prev=13,n=encodeURIComponent(a.searchQuery),e.next=17,Y(n);case 17:r=e.sent,s.setState({groups:r.data,loading:!1,noResultMessage:s.localize("NoResultMessage")}),e.next=24;break;case 21:return e.prev=21,e.t0=e.catch(13),e.abrupt("return",e.t0);case 24:case"end":return e.stop()}}),e,null,[[13,21]])})));return function(t,a){return e.apply(this,arguments)}}(),s.onSave=function(){s.setState({disableButton:!0});var e=[],t=[],a=[];s.state.selectedTeams.map((function(t){return e.push(t.team.id)})),s.state.selectedRosters.map((function(e){return t.push(e.team.id)})),s.state.selectedGroups.map((function(e){return a.push(e.team.id)}));var n={id:s.state.messageId,title:s.state.title,imageLink:s.state.imageLink,summary:s.state.summary,author:s.state.author,buttonTitle:s.state.btnTitle,buttonLink:s.state.btnLink,teams:e,rosters:t,groups:a,allUsers:s.state.allUsersOptionSelected};s.state.exists?s.editDraftMessage(n).then((function(){m.tasks.submitTask()})):s.postDraftMessage(n).then((function(){m.tasks.submitTask()}))},s.editDraftMessage=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,re(t);case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),s.postDraftMessage=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie(t);case 3:return a=e.sent,e.abrupt("return",a.data);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),s.onNext=function(e){s.setState({page:"AudienceSelection"},(function(){s.updateCard()}))},s.onBack=function(e){s.setState({page:"CardCreation"},(function(){s.updateCard()}))},s.onTitleChanged=function(e){var t=!e.target.value&&!s.state.imageLink&&!s.state.summary&&!s.state.author&&!s.state.btnTitle&&!s.state.btnLink;Re(s.card,e.target.value),Ue(s.card,s.state.imageLink),Be(s.card,s.state.summary),qe(s.card,s.state.author),_e(s.card,s.state.btnTitle,s.state.btnLink),s.setState({title:e.target.value,card:s.card},(function(){t&&s.setDefaultCard(s.card),s.updateCard()}))},s.onImageLinkChanged=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")||t.startsWith("data:image/png;base64,")||t.startsWith("data:image/jpeg;base64,")||t.startsWith("data:image/gif;base64,")?s.setState({errorImageUrlMessage:""}):s.setState({errorImageUrlMessage:s.localize("ErrorUrlMessage")});var a=!s.state.title&&!e.target.value&&!s.state.summary&&!s.state.author&&!s.state.btnTitle&&!s.state.btnLink;Re(s.card,s.state.title),Ue(s.card,e.target.value),Be(s.card,s.state.summary),qe(s.card,s.state.author),_e(s.card,s.state.btnTitle,s.state.btnLink),s.setState({imageLink:e.target.value,card:s.card},(function(){a&&s.setDefaultCard(s.card),s.updateCard()}))},s.onSummaryChanged=function(e){var t=!s.state.title&&!s.state.imageLink&&!e.target.value&&!s.state.author&&!s.state.btnTitle&&!s.state.btnLink;Re(s.card,s.state.title),Ue(s.card,s.state.imageLink),Be(s.card,e.target.value),qe(s.card,s.state.author),_e(s.card,s.state.btnTitle,s.state.btnLink),s.setState({summary:e.target.value,card:s.card},(function(){t&&s.setDefaultCard(s.card),s.updateCard()}))},s.onAuthorChanged=function(e){var t=!s.state.title&&!s.state.imageLink&&!s.state.summary&&!e.target.value&&!s.state.btnTitle&&!s.state.btnLink;Re(s.card,s.state.title),Ue(s.card,s.state.imageLink),Be(s.card,s.state.summary),qe(s.card,e.target.value),_e(s.card,s.state.btnTitle,s.state.btnLink),s.setState({author:e.target.value,card:s.card},(function(){t&&s.setDefaultCard(s.card),s.updateCard()}))},s.onBtnTitleChanged=function(e){var t=!s.state.title&&!s.state.imageLink&&!s.state.summary&&!s.state.author&&!e.target.value&&!s.state.btnLink;Re(s.card,s.state.title),Ue(s.card,s.state.imageLink),Be(s.card,s.state.summary),qe(s.card,s.state.author),e.target.value&&s.state.btnLink?(_e(s.card,e.target.value,s.state.btnLink),s.setState({btnTitle:e.target.value,card:s.card},(function(){t&&s.setDefaultCard(s.card),s.updateCard()}))):(delete s.card.actions,s.setState({btnTitle:e.target.value},(function(){t&&s.setDefaultCard(s.card),s.updateCard()})))},s.onBtnLinkChanged=function(e){""===e.target.value||e.target.value.toLowerCase().startsWith("https://")?s.setState({errorButtonUrlMessage:""}):s.setState({errorButtonUrlMessage:s.localize("ErrorUrlMessage")});var t=!s.state.title&&!s.state.imageLink&&!s.state.summary&&!s.state.author&&!s.state.btnTitle&&!e.target.value;Re(s.card,s.state.title),Be(s.card,s.state.summary),qe(s.card,s.state.author),Ue(s.card,s.state.imageLink),s.state.btnTitle&&e.target.value?(_e(s.card,s.state.btnTitle,e.target.value),s.setState({btnLink:e.target.value,card:s.card},(function(){t&&s.setDefaultCard(s.card),s.updateCard()}))):(delete s.card.actions,s.setState({btnLink:e.target.value},(function(){t&&s.setDefaultCard(s.card),s.updateCard()})))},s.updateCard=function(){var e=new Ge.AdaptiveCard;e.parse(s.state.card);var t=e.render(),a=document.getElementsByClassName("adaptiveCardContainer")[0].firstChild;null!=a?a.replaceWith(t):document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(t);var n=s.state.btnLink;e.onExecuteAction=function(e){window.open(n,"_blank")}},Object(ke.a)(),s.localize=s.props.t,s.card=Fe(s.localize),s.setDefaultCard(s.card),s.state={title:"",summary:"",author:"",btnLink:"",imageLink:"",btnTitle:"",card:s.card,page:"CardCreation",teamsOptionSelected:!0,rostersOptionSelected:!1,allUsersOptionSelected:!1,groupsOptionSelected:!1,messageId:"",loader:!0,groupAccess:!1,loading:!1,disableButton:!1,noResultMessage:"",unstablePinned:!0,selectedTeamsNum:0,selectedRostersNum:0,selectedGroupsNum:0,selectedRadioBtn:"teams",selectedTeams:[],selectedRosters:[],selectedGroups:[],errorImageUrlMessage:"",errorButtonUrlMessage:""},s.history=e.history,s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(D.a)(M.a.mark((function e(){var t,a=this;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:m.initialize(),document.addEventListener("keydown",this.escFunction,!1),t=this.props.match.params,this.setGroupAccess(),this.getTeamList().then((function(){if("id"in t){var e=t.id;a.getItem(e).then((function(){var t=a.makeDropdownItemList(a.state.selectedTeams,a.state.teams),s=a.makeDropdownItemList(a.state.selectedRosters,a.state.teams);a.setState({exists:!0,messageId:e,selectedTeams:t,selectedRosters:s})})),a.getGroupData(e).then((function(){var e=a.makeDropdownItems(a.state.groups);a.setState({selectedGroups:e})}))}else a.setState({exists:!1,loader:!1},(function(){var e=new Ge.AdaptiveCard;e.parse(a.state.card);var t=e.render();if(document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(t),a.state.btnLink){var s=a.state.btnLink;e.onExecuteAction=function(e){window.open(s,"_blank")}}}))}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getGroupItems",value:function(){if(this.state.groups)return this.makeDropdownItems(this.state.groups);return[]}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"render",value:function(){var e=this;return this.state.loader?Object(s.jsx)("div",{className:"Loader",children:Object(s.jsx)(I.a,{})}):"CardCreation"===this.state.page?Object(s.jsxs)("div",{className:"taskModule",children:[Object(s.jsxs)("div",{className:"formContainer",children:[Object(s.jsxs)("div",{className:"formContentContainer",children:[Object(s.jsx)(De.Input,{className:"inputField",value:this.state.title,label:this.localize("TitleText"),placeholder:this.localize("PlaceHolderTitle"),onChange:this.onTitleChanged,autoComplete:"off",required:!0}),Object(s.jsx)(De.Input,{className:"inputField",value:this.state.imageLink,label:this.localize("ImageURL"),placeholder:this.localize("ImageURLPlaceHolder"),onChange:this.onImageLinkChanged,errorLabel:this.state.errorImageUrlMessage,autoComplete:"off"}),Object(s.jsx)(De.TextArea,{className:"inputField textArea",autoFocus:!0,placeholder:this.localize("Summary"),label:this.localize("SummaryPlaceHolder"),value:this.state.summary,onChange:this.onSummaryChanged}),Object(s.jsx)(De.Input,{className:"inputField",value:this.state.author,label:this.localize("Author"),placeholder:this.localize("AuthorPlaceHolder"),onChange:this.onAuthorChanged,autoComplete:"off"}),Object(s.jsx)(De.Input,{className:"inputField",value:this.state.btnTitle,label:this.localize("ButtonTitle"),placeholder:this.localize("ButtonTitlePlaceHolder"),onChange:this.onBtnTitleChanged,autoComplete:"off"}),Object(s.jsx)(De.Input,{className:"inputField",value:this.state.btnLink,label:this.localize("ButtonURL"),placeholder:this.localize("ButtonURLPlaceHolder"),onChange:this.onBtnLinkChanged,errorLabel:this.state.errorButtonUrlMessage,autoComplete:"off"})]}),Object(s.jsx)("div",{className:"adaptiveCardContainer"})]}),Object(s.jsx)("div",{className:"footerContainer",children:Object(s.jsx)("div",{className:"buttonContainer",children:Object(s.jsx)(Ne.a,{content:this.localize("Next"),disabled:this.isNextBtnDisabled(),id:"saveBtn",onClick:this.onNext,primary:!0})})})]}):"AudienceSelection"===this.state.page?Object(s.jsxs)("div",{className:"taskModule",children:[Object(s.jsxs)("div",{className:"formContainer",children:[Object(s.jsxs)("div",{className:"formContentContainer",children:[Object(s.jsx)("h3",{children:this.localize("SendHeadingText")}),Object(s.jsxs)(De.RadiobuttonGroup,{className:"radioBtns",value:this.state.selectedRadioBtn,onSelected:this.onGroupSelected,children:[Object(s.jsx)(De.Radiobutton,{className:"bottom-space",name:"grouped",value:"rosters",label:this.localize("SendToRosters")}),this.state.rostersOptionSelected&&Object(s.jsx)(Pe.a,{className:"bottom-space",placeholder:this.localize("SendToRostersPlaceHolder"),search:!0,multiple:!0,items:this.getItems(),value:this.state.selectedRosters,onChange:this.onRostersChange,unstable_pinned:this.state.unstablePinned,noResultsMessage:this.localize("NoMatchMessage")}),Object(s.jsx)(De.Radiobutton,{className:"bottom-space",name:"grouped",value:"groups",label:this.localize("SendToGroups")}),Object(s.jsx)("div",{className:this.state.groupsOptionSelected&&!this.state.groupAccess?"":"hide",children:Object(s.jsx)("div",{className:"noteText",children:Object(s.jsx)(b.a,{error:!0,content:this.localize("SendToGroupsPermissionNote")})})}),this.state.groupsOptionSelected&&this.state.groupAccess&&Object(s.jsx)(Pe.a,{className:"hideToggle",placeholder:this.localize("SendToGroupsPlaceHolder"),search:this.onGroupSearch,multiple:!0,loading:this.state.loading,loadingMessage:this.localize("LoadingText"),items:this.getGroupItems(),value:this.state.selectedGroups,onSearchQueryChange:this.onGroupSearchQueryChange,onChange:this.onGroupsChange,noResultsMessage:this.state.noResultMessage,unstable_pinned:this.state.unstablePinned}),Object(s.jsx)("div",{className:this.state.groupsOptionSelected&&this.state.groupAccess?"":"hide",children:Object(s.jsx)("div",{className:"noteText",children:Object(s.jsx)(b.a,{error:!0,content:this.localize("SendToGroupsNote")})})})]})]}),Object(s.jsx)("div",{className:"adaptiveCardContainer"})]}),Object(s.jsx)("div",{className:"footerContainer",children:Object(s.jsxs)(L.a,{space:"between",children:[Object(s.jsx)(Ne.a,{icon:Object(s.jsx)(Ae.a,{xSpacing:"before"}),content:this.localize("Back"),text:!0,onClick:this.onBack}),Object(s.jsxs)(L.a,{className:"buttonContainer",children:[Object(s.jsx)(Ne.a,{content:this.localize("SaveAsDraft"),disabled:this.isBtnDisabled()||this.state.disableButton,id:"saveBtn",onClick:this.onSave,secondary:!0}),Object(s.jsx)(Ne.a,{content:this.localize("PublishButtonText"),disabled:this.isBtnDisabled()||this.state.disableButton,id:"saveBtn",onClick:function(){return e.onPublish()},primary:!0})]})]})})]}):Object(s.jsx)("div",{children:"Error"})}},{key:"onPublish",value:function(){var e=Object(D.a)(M.a.mark((function e(){var t,a,s,n,r;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.setState({disableButton:!0}),t=[],a=[],s=[],this.state.selectedTeams.map((function(e){return t.push(e.team.id)})),this.state.selectedRosters.map((function(e){return a.push(e.team.id)})),this.state.selectedGroups.map((function(e){return s.push(e.team.id)})),n={id:this.state.messageId,title:this.state.title,imageLink:this.state.imageLink,summary:this.state.summary,author:this.state.author,buttonTitle:this.state.btnTitle,buttonLink:this.state.btnLink,teams:t,rosters:a,groups:s,allUsers:this.state.allUsersOptionSelected},!this.state.exists){e.next=12;break}this.editDraftMessage(n),e.next=15;break;case 12:return e.next=14,this.postDraftMessage(n);case 14:r=e.sent;case 15:this.history.push("/sendconfirmation/"+r);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"escFunction",value:function(e){27!==e.keyCode&&"Escape"!==e.key||m.tasks.submitTask()}}]),a}(n.Component);Ke.MAX_SELECTED_TEAMS_NUM=20;var Qe,Je,Xe=Object(f.a)()(Ke),$e=(a(699),a(769)),Ye=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.initMessage={id:"",title:""},n.card=void 0,n.getItem=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ee(t);case 3:(a=e.sent).data.sendingDuration=B(a.data.sendingStartedDate,a.data.sentDate),a.data.sendingStartedDate=U(a.data.sendingStartedDate),a.data.sentDate=U(a.data.sentDate),a.data.succeeded=q(a.data.succeeded),a.data.failed=q(a.data.failed),a.data.unknown=a.data.unknown&&q(a.data.unknown),n.setState({message:a.data}),e.next=16;break;case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),n.onClose=function(){m.tasks.submitTask()},n.onExport=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader"),e.next=4,Z(n.state.message.id).then((function(){n.setState({page:"SuccessPage"})})).catch((function(){n.setState({page:"ErrorPage"})}));case 4:case"end":return e.stop()}}),e)}))),n.getItemList=function(e){var t=[];return e&&(t=e.map((function(e){return{header:e,media:Object(s.jsx)(j.a,{src:He.makeInitialImage(e),avatar:!0})}}))),t},n.renderAudienceSelection=function(){return n.state.message.teamNames&&n.state.message.teamNames.length>0?Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:n.localize("SentToGeneralChannel")}),Object(s.jsx)(g.a,{items:n.getItemList(n.state.message.teamNames)})]}):n.state.message.rosterNames&&n.state.message.rosterNames.length>0?Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:n.localize("SentToRosters")}),Object(s.jsx)(g.a,{items:n.getItemList(n.state.message.rosterNames)})]}):n.state.message.groupNames&&n.state.message.groupNames.length>0?Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:n.localize("SentToGroups1")}),Object(s.jsx)("span",{children:n.localize("SentToGroups2")}),Object(s.jsx)(g.a,{items:n.getItemList(n.state.message.groupNames)})]}):n.state.message.allUsers?Object(s.jsx)("div",{children:Object(s.jsx)("h3",{children:n.localize("SendToAllUsers")})}):Object(s.jsx)("div",{})},n.renderErrorMessage=function(){return n.state.message.errorMessage?Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:n.localize("Errors")}),Object(s.jsx)("span",{children:n.state.message.errorMessage})]}):Object(s.jsx)("div",{})},n.renderWarningMessage=function(){return n.state.message.warningMessage?Object(s.jsxs)("div",{children:[Object(s.jsx)("h3",{children:n.localize("Warnings")}),Object(s.jsx)("span",{children:n.state.message.warningMessage})]}):Object(s.jsx)("div",{})},Object(ke.a)(),n.localize=n.props.t,n.card=Fe(n.props.t),n.state={message:n.initMessage,loader:!0,page:"ViewStatus"},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params;if("id"in t){var a=t.id;this.getItem(a).then((function(){e.setState({loader:!1},(function(){Re(e.card,e.state.message.title),Ue(e.card,e.state.message.imageLink),Be(e.card,e.state.message.summary),qe(e.card,e.state.message.author),""!==e.state.message.buttonTitle&&""!==e.state.message.buttonLink&&_e(e.card,e.state.message.buttonTitle,e.state.message.buttonLink);var t=new Ge.AdaptiveCard;t.parse(e.card);var a=t.render();document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(a);var s=e.state.message.buttonLink;t.onExecuteAction=function(e){window.open(s,"_blank")}}))}))}}},{key:"render",value:function(){return this.state.loader?Object(s.jsx)("div",{className:"Loader",children:Object(s.jsx)(I.a,{})}):"ViewStatus"===this.state.page?Object(s.jsxs)("div",{className:"taskModule",children:[Object(s.jsxs)("div",{className:"formContainer",children:[Object(s.jsxs)("div",{className:"formContentContainer",children:[Object(s.jsxs)("div",{className:"contentField",children:[Object(s.jsx)("h3",{children:this.localize("TitleText")}),Object(s.jsx)("span",{children:this.state.message.title})]}),Object(s.jsxs)("div",{className:"contentField",children:[Object(s.jsx)("h3",{children:this.localize("SendingStarted")}),Object(s.jsx)("span",{children:this.state.message.sendingStartedDate})]}),Object(s.jsxs)("div",{className:"contentField",children:[Object(s.jsx)("h3",{children:this.localize("Completed")}),Object(s.jsx)("span",{children:this.state.message.sentDate})]}),Object(s.jsxs)("div",{className:"contentField",children:[Object(s.jsx)("h3",{children:this.localize("Duration")}),Object(s.jsx)("span",{children:this.state.message.sendingDuration})]}),Object(s.jsxs)("div",{className:"contentField",children:[Object(s.jsx)("h3",{children:this.localize("Results")}),Object(s.jsx)("label",{children:this.localize("Success",{SuccessCount:this.state.message.succeeded})}),Object(s.jsx)("br",{}),Object(s.jsx)("label",{children:this.localize("Failure",{FailureCount:this.state.message.failed})}),Object(s.jsx)("br",{}),this.state.message.unknown&&Object(s.jsx)(s.Fragment,{children:Object(s.jsx)("label",{children:this.localize("Unknown",{UnknownCount:this.state.message.unknown})})})]}),Object(s.jsx)("div",{className:"contentField",children:this.renderAudienceSelection()}),Object(s.jsx)("div",{className:"contentField",children:this.renderErrorMessage()}),Object(s.jsx)("div",{className:"contentField",children:this.renderWarningMessage()})]}),Object(s.jsx)("div",{className:"adaptiveCardContainer"})]}),Object(s.jsx)("div",{className:"footerContainer",children:Object(s.jsx)("div",{className:this.state.message.canDownload?"":"disabled",children:Object(s.jsxs)("div",{className:"buttonContainer",children:[Object(s.jsx)(I.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("ExportLabel"),labelPosition:"end"}),Object(s.jsx)(T.a,{content:this.state.message.sendingCompleted?this.state.message.canDownload?"":this.localize("ExportButtonProgressText"):"",calloutProps:{gapSpace:0},children:Object(s.jsx)(Ne.a,{icon:Object(s.jsx)($e.a,{size:"medium"}),disabled:!this.state.message.canDownload||!this.state.message.sendingCompleted,content:this.localize("ExportButtonText"),id:"exportBtn",onClick:this.onExport,primary:!0})})]})})})]}):"SuccessPage"===this.state.page?Object(s.jsxs)("div",{className:"taskModule",children:[Object(s.jsx)("div",{className:"formContainer",children:Object(s.jsxs)("div",{className:"displayMessageField",children:[Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{children:Object(s.jsx)(w.a,{className:"iconStyle",xSpacing:"before",size:"largest",outline:!0})}),Object(s.jsx)("h1",{children:this.localize("ExportQueueTitle")})]}),Object(s.jsx)("span",{children:this.localize("ExportQueueSuccessMessage1")}),Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),Object(s.jsx)("span",{children:this.localize("ExportQueueSuccessMessage2")}),Object(s.jsx)("br",{}),Object(s.jsx)("span",{children:this.localize("ExportQueueSuccessMessage3")})]})}),Object(s.jsx)("div",{className:"footerContainer",children:Object(s.jsx)("div",{className:"buttonContainer",children:Object(s.jsx)(Ne.a,{content:this.localize("CloseText"),id:"closeBtn",onClick:this.onClose,primary:!0})})})]}):Object(s.jsxs)("div",{className:"taskModule",children:[Object(s.jsx)("div",{className:"formContainer",children:Object(s.jsxs)("div",{className:"displayMessageField",children:[Object(s.jsx)("br",{}),Object(s.jsx)("br",{}),Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{children:Object(s.jsx)(N.a,{className:"iconStyle",xSpacing:"before",size:"largest",outline:!0})}),Object(s.jsx)("h1",{className:"light",children:this.localize("ExportErrorTitle")})]}),Object(s.jsx)("span",{children:this.localize("ExportErrorMessage")})]})}),Object(s.jsx)("div",{className:"footerContainer",children:Object(s.jsx)("div",{className:"buttonContainer",children:Object(s.jsx)(Ne.a,{content:this.localize("CloseText"),id:"closeBtn",onClick:this.onClose,primary:!0})})})]})}}]),a}(n.Component),Ze=Object(f.a)()(Ye),et=(a(700),a(233)),tt=a(43),at=(a(701),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.initMessage={id:"",title:""},n.card=void 0,n.getItem=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:a=e.sent,n.setState({message:a.data}),e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),n.onSendMessage=function(){document.getElementsByClassName("sendingLoader")[0].classList.remove("hiddenLoader"),ne(n.state.message).then((function(){m.tasks.submitTask()}))},n.getItemList=function(e){var t=[];return e&&(t=e.map((function(e){return{header:e,media:Object(s.jsx)(j.a,{src:He.makeInitialImage(e),avatar:!0})}}))),t},n.renderAudienceSelection=function(){return n.state.teamNames&&n.state.teamNames.length>0?Object(s.jsxs)("div",{children:[" ",Object(s.jsx)("span",{className:"label",children:n.localize("TeamsLabel")}),Object(s.jsx)(g.a,{items:n.getItemList(n.state.teamNames)})]},"teamNames"):n.state.rosterNames&&n.state.rosterNames.length>0?Object(s.jsxs)("div",{children:[" ",Object(s.jsx)("span",{className:"label",children:n.localize("TeamsMembersLabel")}),Object(s.jsx)(g.a,{items:n.getItemList(n.state.rosterNames)})]},"rosterNames"):n.state.groupNames&&n.state.groupNames.length>0?Object(s.jsxs)("div",{children:[" ",Object(s.jsx)("span",{className:"label",children:n.localize("GroupsMembersLabel")}),Object(s.jsx)(g.a,{items:n.getItemList(n.state.groupNames)})]},"groupNames"):n.state.allUsers?Object(s.jsxs)("div",{children:[Object(s.jsx)("span",{className:"label",children:n.localize("AllUsersLabel")}),Object(s.jsx)("div",{className:"noteText",children:Object(s.jsx)(b.a,{error:!0,content:n.localize("SendToAllUsersNote")})})]},"allUsers"):Object(s.jsx)("div",{})},n.localize=n.props.t,n.card=Fe(n.localize),n.state={message:n.initMessage,loader:!0,teamNames:[],rosterNames:[],groupNames:[],allUsers:!1,messageId:0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize();var t=this.props.match.params;if("id"in t){var a=t.id;this.getItem(a).then((function(){oe(a).then((function(t){e.setState({teamNames:t.data.teamNames.sort(),rosterNames:t.data.rosterNames.sort(),groupNames:t.data.groupNames.sort(),allUsers:t.data.allUsers,messageId:a},(function(){e.setState({loader:!1},(function(){Re(e.card,e.state.message.title),Ue(e.card,e.state.message.imageLink),Be(e.card,e.state.message.summary),qe(e.card,e.state.message.author),e.state.message.buttonTitle&&e.state.message.buttonLink&&_e(e.card,e.state.message.buttonTitle,e.state.message.buttonLink);var t=new Ge.AdaptiveCard;t.parse(e.card);var a=t.render();if(document.getElementsByClassName("adaptiveCardContainer")[0].appendChild(a),e.state.message.buttonLink){var s=e.state.message.buttonLink;t.onExecuteAction=function(e){window.open(s,"_blank")}}}))}))}))}))}}},{key:"render",value:function(){return this.state.loader?Object(s.jsx)("div",{className:"Loader",children:Object(s.jsx)(I.a,{})}):Object(s.jsxs)("div",{className:"taskModule",children:[Object(s.jsxs)("div",{className:"formContainer",children:[Object(s.jsxs)("div",{className:"formContentContainer",children:[Object(s.jsxs)("div",{className:"contentField",children:[Object(s.jsx)("h3",{children:this.localize("ConfirmToSend")}),Object(s.jsx)("span",{children:this.localize("SendToRecipientsLabel")})]}),Object(s.jsx)("div",{className:"results",children:this.renderAudienceSelection()})]}),Object(s.jsx)("div",{className:"adaptiveCardContainer"})]}),Object(s.jsx)("div",{className:"footerContainer",children:Object(s.jsxs)("div",{className:"buttonContainer",children:[Object(s.jsx)(I.a,{id:"sendingLoader",className:"hiddenLoader sendingLoader",size:"smallest",label:this.localize("PreparingMessageLabel"),labelPosition:"end"}),Object(s.jsx)(Ne.a,{content:this.localize("Send"),id:"sendBtn",onClick:this.onSendMessage,primary:!0})]})})]})}}]),a}(n.Component)),st=Object(f.a)()(at),nt=a(432),rt=(a(702),function(e){var t=Object(nt.a)().t;return Object(s.jsx)(b.a,{content:function(){var a=e.match.params;if("id"in a){var s=a.id;if("401"===s)return t("UnauthorizedErrorMessage");if("403"===s)return t("ForbiddenErrorMessage")}return t("GeneralErrorMessage")}(),className:"error-message",error:!0,size:"medium"})}),it=(a(703),function(e){var t=Object(nt.a)().t,a=t("SignInPromptMessage");return Object(s.jsxs)("div",{className:"sign-in-content-container",children:[Object(s.jsx)(b.a,{content:a,size:"medium"}),Object(s.jsx)("div",{className:"space"}),Object(s.jsx)(Ne.a,{content:t("SignIn"),primary:!0,className:"sign-in-button",onClick:function(){m.authentication.authenticate({url:window.location.origin+"/signin-simple-start",successCallback:function(){console.log("Login succeeded!"),window.location.href="/messages"},failureCallback:function(e){console.log("Login failed: "+e),window.location.href="/errorpage?locale=".concat(_.language)}})}})]})}),ct=function(){return Object(n.useEffect)((function(){m.initialize(),m.getContext((function(e){var t=window.location.origin.replace("https://",""),a=e.upn?e.upn:"";ue(t,a).then((function(e){window.location.assign(e.data)}))}))})),Object(s.jsx)(s.Fragment,{})},ot=a(164),lt=a(235),ut=a(773),dt=a(774),pt=a(236),ht=x()+"/api",mt=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ht+"/resourcegroups/discover",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gt=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ht+"/resourcegroups",e.next=3,H.post(a,t,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),jt=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ht+"/teamdata/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),bt=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ht+"/resourcegroups/"+t,e.next=3,H.get(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ht+"/resourcegroups",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),xt=function(){var e=Object(D.a)(M.a.mark((function e(t,a){var s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=ht+"/resourcegroups/"+t,e.next=3,H.patch(s,a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),Ot=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ht+"/resourcegroups/"+t,e.next=3,H.delete(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),vt=(a(418),a(770)),kt=a(771),St=(a(704),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).state={showAlert:!1},s}return Object(l.a)(a,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.showAlert!==this.props.showAlert&&this.setState({showAlert:e.showAlert})}},{key:"render",value:function(){return this.props.showAlert?Object(s.jsx)("div",{className:"notification-container",children:Object(s.jsx)("div",{className:"notification-".concat(this.props.notificationStatus?"success":"error"),children:Object(s.jsxs)(L.a,{gap:"gap.smaller",vAlign:"center",children:[Object(s.jsx)(L.a.Item,{children:this.props.notificationStatus?Object(s.jsx)(vt.a,{color:"green"}):Object(s.jsx)(kt.a,{color:"red"})}),Object(s.jsx)(L.a.Item,{children:Object(s.jsx)(b.a,{content:this.props.content,size:"medium"})}),Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)("div",{})}),Object(s.jsx)(N.a,{className:"close-button",onClick:this.props.onClose})]})})}):Object(s.jsx)(s.Fragment,{})}}]),a}(n.Component)),Ct=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.getResourceGroups=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ft();case 2:200===(t=e.sent).status&&t.data&&n.setState({groups:t.data}),n.setState({loader:!1});case 5:case"end":return e.stop()}}),e)}))),n.processLabels=function(){return[{key:"labels",content:Object(s.jsxs)(L.a,{vAlign:"center",fill:!0,gap:"gap.small",children:[Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"20%"},children:Object(s.jsx)(b.a,{truncated:!0,content:n.localize("GroupName")})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"3%"},shrink:!1,children:Object(s.jsx)(b.a,{})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"50%"},shrink:!1,children:Object(s.jsx)(b.a,{truncated:!0,content:n.localize("Description")})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"5%"},children:Object(s.jsx)(b.a,{})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"20%"},children:Object(s.jsx)(b.a,{truncated:!0,content:n.localize("SearchEnabled")})}),Object(s.jsx)(L.a.Item,{shrink:0,children:Object(s.jsx)(b.a,{})})]}),styles:{margin:"0.2rem 0.2rem 0 0"}}]},n.configurationContent=function(e){return Object(s.jsxs)(L.a,{className:"listContainer",vAlign:"center",fill:!0,gap:"gap.small",children:[Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"15%"},grow:1,children:Object(s.jsx)(b.a,{size:"medium",className:"text-color",truncated:!0,content:e.groupName,onClick:function(){return n.openEditTaskModule(e.groupId)}})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"50%"},children:Object(s.jsx)(b.a,{className:"max-width",truncated:!0,content:e.groupDescription})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"5%"},children:Object(s.jsx)(b.a,{})}),Object(s.jsx)(L.a.Item,{size:"size.quarter",variables:{"size.quarter":"15%"},children:Object(s.jsx)(ot.b,{toggle:!0,checked:e.includeInSearchResults,onChange:function(){return n.onSearchEnableChange(e.includeInSearchResults,e,e.groupId)}})}),Object(s.jsx)(L.a,{children:Object(s.jsx)(lt.a,{trigger:Object(s.jsx)(Ne.a,{icon:Object(s.jsx)(me.a,{}),text:!0,iconOnly:!0}),menu:[{icon:Object(s.jsx)(ut.a,{size:"medium"}),key:"Edit",content:n.localize("Edit"),onClick:function(){n.setState({menuOpen:!1}),n.openEditTaskModule(e.groupId)}},{icon:Object(s.jsx)(dt.a,{size:"medium"}),key:"Delete",content:n.localize("Delete"),onClick:function(){n.setState({menuOpen:!1,groupId:e.groupId,groupName:e.groupName,openDeleteDialog:!0})}}]})})]})},n.onSearchEnableChange=function(){var e=Object(D.a)(M.a.mark((function e(t,a,s){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.includeInSearchResults=!t,e.next=3,xt(s,a);case 3:n.getResourceGroups();case 4:case"end":return e.stop()}}),e)})));return function(t,a,s){return e.apply(this,arguments)}}(),n.onDeleteHandleClick=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ot(n.state.groupId);case 2:200!==(t=e.sent).status||t.data||n.setState({openDeleteDialog:!1}),n.getResourceGroups();case 5:case"end":return e.stop()}}),e)}))),n.openEditTaskModule=function(e){m.tasks.startTask({title:n.localize("UpdateERGHeader"),height:O.editTaskModuleHeight,width:O.editTaskModuleWidth,url:x()+"/updateerg/"+e},n.submitEditHandler)},n.submitEditHandler=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getResourceGroups();case 2:case"end":return e.stop()}}),e)}))),n.onFaqSettingButtonClick=function(){m.tasks.startTask({title:n.localize("FaqSettingsText"),height:O.faqSettingsTaskModuleHeight,width:O.faqSettingsTaskModuleWidth,url:x()+"/updateKnowledgeBaseId"},n.submiFaqtHandler)},n.submiFaqtHandler=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),n.onUpdateGroupSubmit=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.showAlert(n.localize("GroupUpdateSuccessMessage"),t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.showAlert=function(e,t){n.setState({alertMessage:e,alertStatus:t,showAlert:!0},(function(){setTimeout((function(){n.setState({showAlert:!1})}),4e3)}))},n.hideAlert=function(){n.setState({showAlert:!1})},n.localize=n.props.t,n.state={loader:!1,menuOpen:!0,groupId:"",groupName:"",openDeleteDialog:!1,theme:"",groups:[],alertMessage:"",alertStatus:!0,showAlert:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(D.a)(M.a.mark((function e(){var t=this;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.initialize(),m.getContext((function(e){t.setState({theme:e.theme})})),this.setState({loader:!0}),e.next=5,this.getResourceGroups();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=0,a=this.processLabels(),n=this.state.groups.map((function(a){return{key:++t,content:e.configurationContent(a),styles:{margin:"0.2rem 0.2rem 0 0"}}})),r=[].concat(Object(C.a)(a),Object(C.a)(n));return this.state.loader?Object(s.jsx)(I.a,{}):Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"title-container",children:[Object(s.jsx)(St,{onClose:this.hideAlert,showAlert:this.state.showAlert,content:this.state.alertMessage,notificationStatus:this.state.alertStatus}),Object(s.jsx)(b.a,{content:this.localize("GroupSetting"),weight:"semibold"}),Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)(L.a,{children:Object(s.jsx)(Ne.a,{primary:!0,className:"faq-setting-button",content:this.localize("FaqSettingsText"),onClick:function(){return e.onFaqSettingButtonClick()}})})})]}),Object(s.jsx)(g.a,{items:r,className:"list"}),Object(s.jsx)(pt.a,{open:this.state.openDeleteDialog,content:Object(s.jsx)(b.a,{className:"word-break",content:this.localize("DeleteContent",{GroupName:this.state.groupName})}),onConfirm:function(){return e.onDeleteHandleClick()},confirmButton:this.localize("Remove"),header:this.localize("DeleteHeaderText"),headerAction:{icon:Object(s.jsx)(N.a,{}),title:"Close",onClick:function(){e.setState({openDeleteDialog:!1})}},closeOnOutsideClick:!0})]})}}]),a}(n.Component),yt=Object(f.a)()(Ct),Tt=function(){return Object(n.useEffect)((function(){m.initialize();var e=function(){var e={};return window.location.hash.substr(1).split("&").forEach((function(t){var a=t.split("="),s=a[0],n=a[1]&&decodeURIComponent(a[1]);e[s]=n})),e}();e.error?m.authentication.notifyFailure(e.error):e.id_token?m.authentication.notifySuccess():m.authentication.notifyFailure("UnexpectedFailure")})),Object(s.jsx)(s.Fragment,{})},Lt=a(783),wt=a(780),Nt=a(781),zt=a(782),It=(a(705),a(118)),Et=(a(419),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.localize=s.props.t,s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){m.initialize()}},{key:"render",value:function(){return Object(s.jsxs)("div",{className:"card-bg",children:[Object(s.jsx)(L.a,{gap:"gap.smaller",vAlign:"center",children:Object(s.jsx)(j.a,{className:"card-img",src:this.props.resourceGroupDetails.imageLink,"data-testid":"group-img"})}),Object(s.jsx)("div",{className:"card-body",children:Object(s.jsxs)(L.a,{gap:"gap.smaller",column:!0,vAlign:"start",children:[Object(s.jsx)(L.a,{gap:"gap.smaller",className:"title-flex",children:Object(s.jsx)("a",{href:this.props.resourceGroupDetails.groupLink,target:"_blank",style:{textDecoration:"none",color:"inherit"},children:Object(s.jsx)(b.a,{className:"card-title-text",size:"large",content:this.props.resourceGroupDetails.groupName,weight:"bold","data-testid":"group-name"})})}),Object(s.jsxs)("div",{className:"footer-flex",children:[Object(s.jsx)(L.a,{gap:"gap.smaller",className:"tags-flex",children:JSON.parse(this.props.tags).map((function(e,t){if(e.trim().length>0)return Object(s.jsx)(It.a,{className:"tags-label-wrapper",circular:!0,content:e.trim(),"data-testid":"group-tag"+t})}))}),Object(s.jsx)(L.a,{className:"card-content-flex",gap:"gap.small",children:Object(s.jsx)(b.a,{size:"small",className:"card-content-text",content:this.props.resourceGroupDetails.groupDescription,"data-testid":"group-desc"})})]})]})})]})}}]),a}(n.Component)),Mt=Object(f.a)()(Et),Dt=a(778),Gt=a(168),Pt=a(85),At=a(107),Ft=a(777),Rt=a(232),Ut=(a(326),function(e){return Object(s.jsx)("div",{children:Object(s.jsx)(L.a,{gap:"gap.small",children:Object(s.jsx)(ot.b,{className:"checkbox-wrapper",label:e.title,checked:e.isChecked,onChange:function(t,a){return e.onChange(e.index,a.checked)}},e.index)})})}),Bt=function(e){var t=Object(nt.a)().t,a=n.useState({checkboxes:e.content.checkboxes}),r=Object(Pt.a)(a,1)[0],i=n.useState(e.content.checkboxes),c=Object(Pt.a)(i,2),o=c[0],l=c[1],u=n.useState(!0),d=Object(Pt.a)(u,2),p=d[0],h=d[1],m=n.useState(!1),g=Object(Pt.a)(m,2),j=g[0],b=g[1];return Object(s.jsx)(et.a,{children:Object(s.jsx)("div",{className:"content-items-wrapper",children:Object(s.jsxs)("div",{className:"content-items-body",children:[Object(s.jsx)(L.a,{gap:"gap.small",vAlign:"center",hAlign:"end",children:Object(s.jsx)(Ne.a,{disabled:j?p:e.disableClear,className:"clear-button",icon:Object(s.jsx)(N.a,{}),size:"small",text:!0,onClick:function(){return function(){var t=o.map((function(e){return e.isChecked=!1,e}));l(t),e.onCheckboxStateChange(t),h(!0),b(!0)}()},content:t("ClearAll")})}),Object(s.jsx)(Rt.a,{className:"filter-popup-menu-divider"}),o.map((function(t){if(t.title.trim().length)return Object(s.jsx)(Ut,{title:t.checkboxLabel,isChecked:t.isChecked,index:t.key,onChange:function(t,a){return function(t,a){var s=0;b(!0);var n=r.checkboxes.map((function(e){return e.key===t&&(e.isChecked=a),e}));n.map((function(e){e.isChecked&&(s+=1)})),h(!(s>0)),e.onCheckboxStateChange(n)}(t,a)}})}))]})})})},qt=function(e){var t=n.useState({isOpen:!1}),a=Object(Pt.a)(t,2),r=a[0],i=a[1],c=n.useState(!0),o=Object(Pt.a)(c,2),l=o[0],u=o[1];return Object(s.jsx)(At.a,{open:r.isOpen,align:"center",position:"below",onOpenChange:function(e,t){var a=t.open;return i({isOpen:a})},trigger:Object(s.jsx)(Ne.a,{className:"mobile-button ".concat(r.isOpen?"gray-background":"no-background"),onClick:function(){return function(){var t=0;e.checkboxes.map((function(e){e.isChecked&&(t+=1)})),u(!(t>0))}()},content:Object(s.jsx)(b.a,{content:e.title}),iconPosition:"after",icon:Object(s.jsx)(Ft.a,{}),text:!0}),content:Object(s.jsx)(Bt,{disableClear:l,content:{checkboxes:e.checkboxes,title:e.title},onCheckboxStateChange:e.onCheckboxStateChange}),trapFocus:!0})},_t=a(779),Vt=a(786),Wt=x()+"/api",Ht=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Wt+"/settings",e.next=3,H.get(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Kt=(a(708),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.botId=void 0,n.getAppSetting=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ht();case 2:(t=e.sent).data&&(n.botId=t.data.appId);case 4:case"end":return e.stop()}}),e)}))),n.resize=function(){window.innerWidth!==n.state.screenWidth&&n.setState({screenWidth:window.innerWidth})},n.onLocationCheckboxStateChange=function(e){n.setState({locationsList:e}),n.props.onLocationCheckboxStateChange(e)},n.onTagsCheckboxStateChange=function(e){n.setState({tagsList:e}),n.props.onTagsCheckboxStateChange(e)},n.onFilterButtonClick=function(){!1===n.state.isFilterEnabled?n.setState({isFilterEnabled:!0,hideFilter:!1}):!0===n.state.isFilterEnabled&&n.setState({isFilterEnabled:!1,hideFilter:!0})},n.handleAddClick=function(){m.tasks.startTask({completionBotId:n.botId,title:n.localize("NewERGHeader"),height:O.editTaskModuleHeight,width:O.editTaskModuleWidth,url:"".concat(x(),"/createNewGroup")},n.submitHandler)},n.submitHandler=Object(D.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),n.botId="",Object(ke.a)(),n.localize=n.props.t,n.state={tagsList:n.props.tagsList.map((function(e,t){return{id:e,isChecked:!1,key:t,title:e,checkboxLabel:Object(s.jsx)(b.a,{content:e})}})),locationsList:n.props.locationsList.map((function(e,t){return{id:e,isChecked:!1,key:t,title:e,checkboxLabel:Object(s.jsx)(b.a,{content:e})}})),screenWidth:O.screenWidth,isFilterEnabled:!1,hideFilter:!0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize.bind(this)),this.getAppSetting(),this.resize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize.bind(this))}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{children:[this.state.screenWidth>O.screenWidth&&Object(s.jsx)("div",{className:"filter-bar",children:Object(s.jsx)("div",{children:Object(s.jsxs)(L.a,{gap:"gap.small",children:[Object(s.jsx)("div",{className:"filter-bar-title-container",children:Object(s.jsx)(Ne.a,{icon:Object(s.jsx)(Dt.a,{xSpacing:"before",size:"smaller"}),content:this.localize("NewERGTitleText"),onClick:this.handleAddClick,text:!0})}),Object(s.jsxs)("div",{className:"filter-bar-item-container",hidden:this.state.hideFilter,children:[Object(s.jsx)(qt,{title:this.localize("Location"),checkboxes:this.state.locationsList,onCheckboxStateChange:this.onLocationCheckboxStateChange}),Object(s.jsx)(qt,{title:this.localize("Tags"),checkboxes:this.state.tagsList,onCheckboxStateChange:this.onTagsCheckboxStateChange})]}),Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsxs)(L.a,{children:[Object(s.jsx)(Ne.a,{className:"filter-button",content:Object(s.jsx)(b.a,{content:this.localize("Filter")}),icon:this.state.isFilterEnabled?Object(s.jsx)(Vt.a,{iconName:"FilterSolid",className:"filter-icon-filled"}):Object(s.jsx)(Vt.a,{iconName:"Filter",className:"filter-icon"}),text:!0,onClick:this.onFilterButtonClick}),Object(s.jsx)(Gt.a,{inverted:!0,fluid:!0,placeholder:this.localize("SearchPlaceholder"),onChange:function(t){return e.props.onSearchInputChange(t.target.value)},value:this.props.commandBarSearchText,"data-testid":"search-input"}),Object(s.jsx)(_t.a,{className:"discover-search-icon"},"search")]})})]})})}),this.state.screenWidth<=O.screenWidth&&Object(s.jsx)(L.a,{gap:"gap.small",vAlign:"start",className:"filter-bar-wrapper",children:Object(s.jsx)(L.a.Item,{grow:!0,children:Object(s.jsxs)(L.a,{column:!0,gap:"gap.small",vAlign:"stretch",children:[Object(s.jsxs)(L.a,{className:"mobile-filterbar-title-wrapper",children:[Object(s.jsx)("div",{className:"title-container-mobile",children:Object(s.jsx)(b.a,{content:this.localize("NewERGTitleText"),weight:"semibold"})}),Object(s.jsx)(Ne.a,{className:"filter-button",content:Object(s.jsx)(b.a,{content:this.localize("Filter")}),icon:this.state.isFilterEnabled?Object(s.jsx)(Vt.a,{iconName:"FilterSolid",className:"filter-icon-filled"}):Object(s.jsx)(Vt.a,{iconName:"Filter",className:"filter-icon"}),text:!0,onClick:this.onFilterButtonClick}),Object(s.jsxs)("div",{className:"searchbar-wrapper-mobile",children:[Object(s.jsx)(Gt.a,{className:"searchbar-wrapper-mobile",inverted:!0,fluid:!0,placeholder:this.localize("SearchPlaceholder"),onChange:function(t){return e.props.onSearchInputChange(t.target.value)},value:this.props.commandBarSearchText}),Object(s.jsx)(_t.a,{className:"discover-search-icon-mobile"},"search")]})]}),Object(s.jsx)(L.a,{className:"mobile-filterbar-wrapper",children:Object(s.jsxs)(L.a,{hidden:this.state.hideFilter,children:[Object(s.jsx)(qt,{title:this.localize("Location"),checkboxes:this.state.locationsList,onCheckboxStateChange:this.onLocationCheckboxStateChange}),Object(s.jsx)(qt,{title:this.localize("Tags"),checkboxes:this.state.tagsList,onCheckboxStateChange:this.onTagsCheckboxStateChange})]})})]})})})]})}}]),a}(n.Component)),Qt=Object(f.a)()(Kt),Jt=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var s;return Object(o.a)(this,a),(s=t.call(this,e)).localize=void 0,s.discoverResourceGroupsAsync=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,mt();case 2:200===(t=e.sent).status&&t.data&&s.setState({resourceGroups:t.data}),s.setFilterBarValues(),s.setState({loader:!1});case 6:case"end":return e.stop()}}),e)}))),s.onCreateGroupSubmit=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.showAlert(s.localize("GroupCreatedSuccessMessage"),t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.showAlert=function(e,t){s.setState({alertMessage:e,alertStatus:t,showAlert:!0},(function(){setTimeout((function(){s.setState({showAlert:!1})}),4e3)}))},s.hideAlert=function(){s.setState({showAlert:!1})},s.setFilterBarValues=function(){var e=new Array,t=new Array;s.state.resourceGroups.length>0&&(s.state.resourceGroups.forEach((function(a,s){e.find((function(e){return e.toUpperCase()===a.location.toUpperCase()}))||e.push(a.location),JSON.parse(a.tags).forEach((function(e){t.find((function(t){return t.toUpperCase()===e.toUpperCase()}))||t.push(e)}))})),s.setState({locationsList:e.sort(),tagsList:t.sort()}))},s.onLocationCheckboxStateChange=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.filter((function(e){return e.isChecked})).map((function(e){return e.id.toString().toUpperCase().trim()})),s.setState({selectedLocationsList:a});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.onTagsCheckboxStateChange=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.filter((function(e){return e.isChecked})).map((function(e){return e.id.toString().toUpperCase().trim()})),e.next=3,s.setState({selectedTagsList:a});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.handleSearchInputChange=function(){var e=Object(D.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.setState({searchText:t});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.localize=s.props.t,s.state={loader:!0,resourceGroups:[],tagsList:[],locationsList:[],selectedLocationsList:[],selectedTagsList:[],searchText:"",alertMessage:"",alertStatus:!0,showAlert:!1},s}return Object(l.a)(a,[{key:"componentDidMount",value:function(){m.initialize(),this.discoverResourceGroupsAsync()}},{key:"render",value:function(){var e=this;if(this.state.loader)return Object(s.jsx)("div",{className:"container-div",children:Object(s.jsx)("div",{className:"container-subdiv",children:Object(s.jsx)("div",{className:"loader",children:Object(s.jsx)(I.a,{})})})});var t=this.state.selectedLocationsList.length>0?this.state.resourceGroups.filter((function(t){return e.state.selectedLocationsList.includes(t.location.toUpperCase())})):this.state.resourceGroups;this.state.selectedTagsList.length>0&&(t=t.filter((function(t){return JSON.parse(t.tags).some((function(t){return e.state.selectedTagsList.includes(t.toUpperCase())}))}))),""===this.state.searchText&&null===this.state.searchText||(t=t.filter((function(t){return-1!==t.groupName.toUpperCase().indexOf(e.state.searchText.toUpperCase())||-1!==t.groupDescription.toUpperCase().indexOf(e.state.searchText.toUpperCase())})));var a=new Array;t.forEach((function(e){a.push(Object(s.jsx)(wt.a,{lg:3,sm:6,md:4,className:"grid-column d-flex justify-content-center",children:Object(s.jsx)(Mt,{resourceGroupDetails:e,tags:e.tags})}))}));return Object(s.jsx)("div",{className:"site-div",children:Object(s.jsx)("div",{className:"site-subdiv-cardview",children:Object(s.jsxs)(Nt.a,{fluid:!0,className:"container-fluid-overriden",children:[Object(s.jsx)(St,{onClose:this.hideAlert,showAlert:this.state.showAlert,content:this.state.alertMessage,notificationStatus:this.state.alertStatus}),Object(s.jsx)(Qt,{tagsList:this.state.tagsList,locationsList:this.state.locationsList,commandBarSearchText:this.state.searchText,onSearchInputChange:this.handleSearchInputChange,onLocationCheckboxStateChange:this.onLocationCheckboxStateChange,onTagsCheckboxStateChange:this.onTagsCheckboxStateChange,onCreateGroupSubmit:this.onCreateGroupSubmit}),Object(s.jsx)("div",{className:"scroll-view",style:{height:"92vh"},children:Object(s.jsx)(zt.a,{children:a.length>0?a:Object(s.jsxs)("div",{className:"no-post-added-container",children:[Object(s.jsx)("div",{className:"app-logo",children:Object(s.jsx)(Lt.a,{size:"largest"})}),Object(s.jsx)("div",{className:"no-data-preview",children:Object(s.jsx)(b.a,{content:this.localize("NoResultsText")})})]})})})]})})})}}]),a}(n.Component),Xt=Object(f.a)()(Jt),$t=a(784);!function(e){e.teams="Teams",e.external="External"}(Qe||(Qe={})),function(e){e[e.weekly=0]="weekly",e[e.monthly=1]="monthly"}(Je||(Je={}));a(421);var Yt=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.userObjectId="",n.handleSubmit=function(){if(n.checkIfSubmitAllowed()){n.setState({submitLoading:!0});var e={groupType:n.state.selectedGroupType,groupName:n.state.selectedGroupType===Qe.external?n.state.groupName:n.state.teamName,groupDescription:n.state.selectedGroupType===Qe.external?n.state.groupDescription:n.state.teamDescription,groupLink:n.state.selectedGroupType===Qe.external?n.state.groupLink:n.state.teamLink,imageLink:n.state.imageLink,location:n.state.location,includeInSearchResults:!1,tags:JSON.stringify(n.state.tagsList)};n.createNewEmployeeResourceGroup(e)}},n.checkIfSubmitAllowed=function(){return n.isNullOrWhiteSpace(n.state.groupType)?(n.setState({isGroupTypePresent:!1}),!1):n.state.selectedGroupType===Qe.external&&n.isNullOrWhiteSpace(n.state.groupName)?(n.setState({isGroupNamePresent:!1}),!1):n.state.selectedGroupType===Qe.external&&n.isNullOrWhiteSpace(n.state.groupDescription)?(n.setState({isGroupDescriptionPresent:!1}),!1):n.state.selectedGroupType===Qe.external&&n.isNullOrWhiteSpace(n.state.groupLink)?(n.setState({isGroupLinkPresent:!1}),!1):n.state.selectedGroupType===Qe.teams&&n.isNullOrWhiteSpace(n.state.teamLink)?(n.setState({isTeamLinkPresent:!1}),!1):n.state.selectedGroupType===Qe.teams&&n.isNullOrWhiteSpace(n.state.teamName)?(n.setState({isTeamNamePresent:!1}),!1):n.state.selectedGroupType===Qe.teams&&n.isNullOrWhiteSpace(n.state.teamDescription)?(n.setState({isTeamDescriptionPresent:!1}),!1):(n.state.selectedGroupType!==Qe.teams||n.state.errorMessage!==n.localize("TeamNotExists"))&&(n.isNullOrWhiteSpace(n.state.imageLink)?(n.setState({isImageLinkPresent:!1}),!1):!n.isNullOrWhiteSpace(n.state.location)||(n.setState({isLocationPresent:!1}),!1))},n.isNullOrWhiteSpace=function(e){return!e||!e.trim()},n.checkIfTagIsValid=function(){var e={isEmpty:!1,isLengthValid:!0,isExisting:!1,isTagsCountValid:!1,containsSemicolon:!1};""===n.state.tag.trim()&&(e.isEmpty=!0),n.state.tag.length>O.stateTagMaxLength&&(e.isLengthValid=!1);var t=n.state.tagsList.find((function(e){return e.toLowerCase()===n.state.tag.toLowerCase()}));return n.state.tag.split(";").length>1&&(e.containsSemicolon=!0),t&&(e.isExisting=!0),n.state.tagsList.length<O.stateTagMaxCount&&(e.isTagsCountValid=!0),n.setState({tagValidation:e}),!(e.isEmpty||e.isExisting||!e.isLengthValid||!e.isTagsCountValid||e.containsSemicolon)},n.onTagRemoveClick=function(e){var t=n.state.tagsList;t.splice(e,1),n.setState({tagsList:t})},n.getTagError=function(){return n.state.tagValidation.isEmpty?Object(s.jsx)(b.a,{content:n.localize("EmptyTagError"),error:!0,size:"small"}):n.state.tagValidation.isLengthValid?n.state.tagValidation.isExisting?Object(s.jsx)(b.a,{content:n.localize("SameTagExistsError"),error:!0,size:"small"}):n.state.tagValidation.isTagsCountValid?n.state.tagValidation.containsSemicolon?Object(s.jsx)(b.a,{content:n.localize("SemicolonTagError"),error:!0,size:"small"}):Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{content:n.localize("TagsCountError"),error:!0,size:"small"}):Object(s.jsx)(b.a,{content:n.localize("TagLengthError"),error:!0,size:"small"})},n.onTagAddClick=function(){if(n.checkIfTagIsValid()){var e=n.state.tagsList;e.push(n.state.tag.toLowerCase()),n.setState({tagsList:e,tag:""})}},n.onTagKeyUp=function(e){"Enter"===e.key&&n.onTagAddClick()},n.onTagChange=function(e){n.setState({tag:e})},n.onGroupTypeChange=function(e,t){t.value===n.localize("Teams")?n.setState({selectedGroupType:Qe.teams,groupType:t.value,isGroupTypePresent:!0,isTeamsSelected:!0,isExternalSelected:!1}):n.setState({selectedGroupType:Qe.external,groupType:t.value,isGroupTypePresent:!0,isExternalSelected:!0,isTeamsSelected:!1})},n.onGroupNameChange=function(e){n.setState({groupName:e,isGroupNamePresent:!0})},n.onGroupDescriptionChange=function(e){n.setState({groupDescription:e,isGroupDescriptionPresent:!0})},n.onGroupLinkChange=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")?n.setState({groupLink:e.target.value,isGroupLinkValid:!0}):n.setState({isGroupLinkValid:!1,isGroupLinkPresent:!0})},n.onTeamNameChange=function(e){n.setState({teamName:e,isTeamNamePresent:!0})},n.onTeamDescriptionChange=function(e){n.setState({teamDescription:e,isTeamDescriptionPresent:!0})},n.onTeamLinkChange=function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s,r,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===(a=t.target.value.toLowerCase())||a.startsWith("https://teams.microsoft.com/l/team")){e.next=5;break}n.setState({isTeamLinkValid:!1,isTeamLinkPresent:!0}),e.next=12;break;case 5:return n.setState({teamLink:t.target.value,isTeamLinkValid:!0}),s=a.split("?")[1],r=s.split("&")[0],e.next=10,jt(r.split("=")[1]);case 10:200===(i=e.sent).status&&i.data?n.setState({teamName:i.data.name,teamDescription:i.data.description}):204===i.status&&n.setState({errorMessage:n.localize("TeamNotExists")});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onImageLinkChange=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")||t.startsWith("data:image/png;base64,")||t.startsWith("data:image/jpeg;base64,")||t.startsWith("data:image/gif;base64,")?n.setState({imageLink:e.target.value,isImageLinkValid:!0}):n.setState({isImageLinkValid:!1,isImageLinkPresent:!0})},n.onLocationChange=function(e){n.setState({location:e,isLocationPresent:!0})},n.onSearchEnableChange=function(e){n.setState({searchEnabled:!e})},n.getRequiredFieldError=function(e){return e?Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{"data-testid":"empty_validation",content:n.localize("RequiredFieldMessage"),error:!0,size:"small"})},n.getInvalidUrlError=function(e){return e?Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{"data-testid":"url_validation",content:n.localize("InvalidUrlMessage"),error:!0,size:"small"})},n.localize=n.props.t,n.state={loading:!0,theme:"",tagsList:[],tag:"",tagValidation:{isEmpty:!1,isExisting:!1,isLengthValid:!0,isTagsCountValid:!0,containsSemicolon:!1},groupType:"",selectedGroupType:"",groupName:"",groupDescription:"",groupLink:"",teamName:"",teamDescription:"",teamLink:"",imageLink:"",location:"",searchEnabled:!1,isGroupTypePresent:!0,isGroupNamePresent:!0,isGroupDescriptionPresent:!0,isGroupLinkPresent:!0,isGroupLinkValid:!0,isTeamNamePresent:!0,isTeamDescriptionPresent:!0,isTeamLinkPresent:!0,isImageLinkPresent:!0,isLocationPresent:!0,isTeamLinkValid:!0,isImageLinkValid:!0,isExternalSelected:!1,isTeamsSelected:!1,errorMessage:"",submitLoading:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){e.userObjectId=t.userObjectId,e.setState({theme:t.theme,loading:!1})}))}},{key:"createNewEmployeeResourceGroup",value:function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,gt(t);case 3:201===(a=e.sent).status&&a.data&&(this.setState({submitLoading:!1,errorMessage:""}),s={command:O.groupCreatedBotCommand,GroupId:this.state.searchEnabled?a.data.groupId:null},m.tasks.submitTask(s)),e.next=14;break;case 7:if(e.prev=7,e.t0=e.catch(0),400!==e.t0.response.status&&403!==e.t0.response.status){e.next=13;break}this.setState({submitLoading:!1,errorMessage:e.t0.response.data.value}),e.next=14;break;case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loading?Object(s.jsx)(I.a,{}):Object(s.jsxs)("div",{className:"default"===this.state.theme?"backgroundcolor":"",children:[Object(s.jsxs)(L.a,{className:"tab-container",column:!0,children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_type_field",size:"small",content:this.localize("GroupType")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupTypePresent)})]}),Object(s.jsx)(Pe.a,{className:"between-space",fluid:!0,placeholder:this.localize("GroupTypePlaceHolder"),items:[this.localize("External"),this.localize("Teams")],value:this.state.groupType,onChange:this.onGroupTypeChange,"data-testid":"group_type_dropdown"}),this.state.isExternalSelected&&Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_name_field",size:"small",content:this.localize("GroupName")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupNamePresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthName,fluid:!0,placeholder:this.localize("GroupNamePlaceHolder"),value:this.state.groupName,onChange:function(t){return e.onGroupNameChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_description_field",size:"small",content:this.localize("GroupDescription")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupDescriptionPresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthDescription,fluid:!0,placeholder:this.localize("GroupDescriptionPlaceHolder"),value:this.state.groupDescription,onChange:function(t){return e.onGroupDescriptionChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_link_field",size:"small",content:this.localize("GroupLink")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupLinkPresent)}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getInvalidUrlError(this.state.isGroupLinkValid)})]}),Object(s.jsx)(Gt.a,{className:"between-space",fluid:!0,placeholder:this.localize("GroupLinkPlaceHolder"),value:this.state.groupLink,onChange:this.onGroupLinkChange})]}),this.state.isTeamsSelected&&Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"team_link_field",size:"small",content:this.localize("TeamLink")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isTeamLinkPresent)}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getInvalidUrlError(this.state.isTeamLinkValid)})]}),Object(s.jsx)(Gt.a,{className:"between-space",fluid:!0,placeholder:this.localize("TeamLinkPlaceHolder"),value:this.state.teamLink,onChange:this.onTeamLinkChange}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"team_name_field",size:"small",content:this.localize("TeamName")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isTeamNamePresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthName,fluid:!0,placeholder:this.localize("TeamNamePlaceHolder"),value:this.state.teamName,onChange:function(t){return e.onTeamNameChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"team_description_field",size:"small",content:this.localize("TeamDescription")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isTeamDescriptionPresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthDescription,fluid:!0,placeholder:this.localize("TeamDescriptionPlaceHolder"),value:this.state.teamDescription,onChange:function(t){return e.onTeamDescriptionChange(t.target.value)}})]}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"image_link_field",size:"small",content:this.localize("ImageLink")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isImageLinkPresent)}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getInvalidUrlError(this.state.isImageLinkValid)})]}),Object(s.jsx)(Gt.a,{className:"between-space",fluid:!0,placeholder:this.localize("ImageLinkPlaceHolder"),value:this.state.imageLink,onChange:this.onImageLinkChange,"data-testid":"image_url"}),Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"tags_field",size:"small",content:this.localize("Tags")}),Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)("div",{children:this.getTagError()})})]}),Object(s.jsx)(Gt.a,{className:"between-space",placeholder:this.localize("TagsPlaceHolder"),fluid:!0,value:this.state.tag,onKeyDown:this.onTagKeyUp,onChange:function(t){return e.onTagChange(t.target.value)}}),Object(s.jsx)(L.a,{children:Object(s.jsx)("div",{children:this.state.tagsList.map((function(t,a){if(t.trim().length>0)return Object(s.jsx)(It.a,{circular:!0,className:"default"===e.state.theme?"tags-label-wrapper":"tags-label-wrapper-dark",content:Object(s.jsx)(b.a,{content:t.trim(),title:t.trim(),size:"medium"}),icon:Object(s.jsx)(N.a,{outline:!0,onClick:function(){return e.onTagRemoveClick(a)}},a)})}))})})]}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"location_field",size:"small",content:this.localize("Location")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isLocationPresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.stateLocationMaxLength,fluid:!0,placeholder:this.localize("LocationPlaceHolder"),value:this.state.location,onChange:function(t){return e.onLocationChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"searchenabled_field",className:"margin-space",content:this.localize("SearchEnabled")}),Object(s.jsx)($t.a,{outline:!0,xSpacing:"after",title:this.localize("TagInfo"),size:"small"}),Object(s.jsx)(ot.b,{toggle:!0,checked:this.state.searchEnabled,onChange:function(){return e.onSearchEnableChange(e.state.searchEnabled)}})]})]}),Object(s.jsxs)(L.a,{className:"tab-footer",hAlign:"end",children:[Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)(b.a,{className:"error-info",content:this.state.errorMessage,error:!0,size:"medium"})}),Object(s.jsx)(Ne.a,{primary:!0,content:this.localize("SubmitText"),onClick:this.handleSubmit,disabled:this.state.submitLoading,loading:this.state.submitLoading,"data-testid":"submit_button"})]})]})}}]),a}(n.Component),Zt=Object(f.a)()(Yt),ea=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.userObjectId="",n.getResourceGroup=function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,bt(t);case 2:200===(a=e.sent).status&&a.data&&(s=new Array,JSON.parse(a.data.tags).forEach((function(e){s.push(e)})),n.setState({groupType:a.data.groupType,isTeamsSelected:a.data.groupType===Qe.teams,isExternalSelected:a.data.groupType!==Qe.teams,imageLink:a.data.imageLink,tagsList:s,location:a.data.location,searchEnabled:a.data.includeInSearchResults,profileMatchFrequency:a.data.profileMatchFrequency,isProfileMatchingEnabled:a.data.isProfileMatchingEnabled,isFrequencyTypeMonthly:a.data.matchingFrequency===Je.monthly}),a.data.groupType!==Qe.teams?n.setState({groupName:a.data.groupName,groupDescription:a.data.groupDescription,groupLink:a.data.groupLink}):n.setState({teamName:a.data.groupName,teamDescription:a.data.groupDescription,teamLink:a.data.groupLink}),n.state.isFrequencyTypeMonthly?n.setState({frequency:n.localize("EveryMonth")}):n.setState({frequency:n.localize("EveryWeek")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.handleSubmit=function(){if(n.checkIfSubmitAllowed()){n.setState({submitLoading:!0});var e={groupId:n.state.groupId,groupType:n.state.groupType,groupName:n.state.groupType===n.localize("External")?n.state.groupName:n.state.teamName,groupDescription:n.state.groupType===n.localize("External")?n.state.groupDescription:n.state.teamDescription,groupLink:n.state.groupType===n.localize("External")?n.state.groupLink:n.state.teamLink,imageLink:n.state.imageLink,location:n.state.location,includeInSearchResults:n.state.searchEnabled,tags:JSON.stringify(n.state.tagsList),isProfileMatchingEnabled:n.state.isProfileMatchingEnabled,matchingFrequency:n.state.isFrequencyTypeMonthly?Je.monthly:Je.weekly};n.updateEmployeeResourceGroup(e)}},n.checkIfSubmitAllowed=function(){return n.isNullorWhiteSpace(n.state.groupType)?(n.setState({isGroupTypePresent:!1}),!1):n.state.groupType===Qe.external&&n.isNullorWhiteSpace(n.state.groupName)?(n.setState({isGroupNamePresent:!1}),!1):n.state.groupType===Qe.external&&n.isNullorWhiteSpace(n.state.groupDescription)?(n.setState({isGroupDescriptionPresent:!1}),!1):n.state.groupType==Qe.external&&n.isNullorWhiteSpace(n.state.groupLink)?(n.setState({isGroupLinkPresent:!1}),!1):n.state.groupType===Qe.teams&&n.isNullorWhiteSpace(n.state.teamLink)?(n.setState({isTeamLinkPresent:!1}),!1):n.state.groupType===Qe.teams&&n.isNullorWhiteSpace(n.state.teamName)?(n.setState({isTeamNamePresent:!1}),!1):n.state.groupType===Qe.teams&&n.isNullorWhiteSpace(n.state.teamDescription)?(n.setState({isTeamDescriptionPresent:!1}),!1):n.isNullorWhiteSpace(n.state.imageLink)?(n.setState({isImageLinkPresent:!1}),!1):!n.isNullorWhiteSpace(n.state.location)||(n.setState({isLocationPresent:!1}),!1)},n.isNullorWhiteSpace=function(e){return!e||!e.trim()},n.checkIfTagIsValid=function(){var e={isEmpty:!1,isLengthValid:!0,isExisting:!1,isTagsCountValid:!1,containsSemicolon:!1};""===n.state.tag.trim()&&(e.isEmpty=!0),n.state.tag.length>O.stateTagMaxLength&&(e.isLengthValid=!1);var t=n.state.tagsList.find((function(e){if(e.toLowerCase()===n.state.tag.toLowerCase())return e}));return n.state.tag.split(";").length>1&&(e.containsSemicolon=!0),t&&(e.isExisting=!0),n.state.tagsList.length<O.stateTagMaxCount&&(e.isTagsCountValid=!0),n.setState({tagValidation:e}),!(e.isEmpty||e.isExisting||!e.isLengthValid||!e.isTagsCountValid||e.containsSemicolon)},n.onTagRemoveClick=function(e){var t=n.state.tagsList.filter((function(t,a){return a!==e}));n.setState({tagsList:t})},n.getTagError=function(){return n.state.tagValidation.isEmpty?Object(s.jsx)(b.a,{content:n.localize("EmptyTagError"),error:!0,size:"small"}):n.state.tagValidation.isLengthValid?n.state.tagValidation.isExisting?Object(s.jsx)(b.a,{content:n.localize("SameTagExistsError"),error:!0,size:"small"}):n.state.tagValidation.isTagsCountValid?n.state.tagValidation.containsSemicolon?Object(s.jsx)(b.a,{content:n.localize("SemicolonTagError"),error:!0,size:"small"}):Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{content:n.localize("TagsCountError"),error:!0,size:"small"}):Object(s.jsx)(b.a,{content:n.localize("TagLengthError"),error:!0,size:"small"})},n.onTagAddClick=function(){if(n.checkIfTagIsValid()){var e=[].concat(Object(C.a)(n.state.tagsList),[n.state.tag]);n.setState({tagsList:e,tag:""})}},n.onTagKeyUp=function(e){"Enter"===e.key&&n.onTagAddClick()},n.onTagChange=function(e){n.setState({tag:e})},n.onGroupTypeChange=function(e,t){t.value===n.localize("Teams")?n.setState({groupType:t.value,isGroupTypePresent:!0,isTeamsSelected:!0,isExternalSelected:!1}):n.setState({groupType:t.value,isGroupTypePresent:!0,isExternalSelected:!0,isTeamsSelected:!1})},n.onFrequencyTypeChange=function(e,t){t.value===n.localize("EveryWeek")?n.setState({isFrequencyTypeMonthly:!1,frequency:n.localize("EveryWeek")}):n.setState({isFrequencyTypeMonthly:!0,frequency:n.localize("EveryMonth")})},n.onGroupNameChange=function(e){n.setState({groupName:e,isGroupNamePresent:!0})},n.onGroupDescriptionChange=function(e){n.setState({groupDescription:e,isGroupDescriptionPresent:!0})},n.onGroupLinkChange=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")?n.setState({groupLink:e.target.value,isGroupLinkValid:!0}):n.setState({isGroupLinkValid:!1,isGroupLinkPresent:!0})},n.onTeamNameChange=function(e){n.setState({teamName:e,isTeamNamePresent:!0})},n.onTeamDescriptionChange=function(e){n.setState({teamDescription:e,isTeamDescriptionPresent:!0})},n.onTeamLinkChange=function(){var e=Object(D.a)(M.a.mark((function e(t){var a,s,r,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""===(a=t.target.value.toLowerCase())||a.startsWith("https://teams.microsoft.com/l/team")){e.next=5;break}n.setState({isTeamLinkValid:!1,isTeamLinkPresent:!0}),e.next=12;break;case 5:return n.setState({teamLink:t.target.value,isTeamLinkValid:!0}),s=a.split("?")[1],r=s.split("&")[0],e.next=10,jt(r.split("=")[1]);case 10:200===(i=e.sent).status&&i.data?n.setState({teamName:i.data.teamDisplayName,teamDescription:i.data.teamDescription}):204===i.status&&n.setState({errorMessage:n.localize("TeamNotExists")});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.onImageLinkChange=function(e){var t=e.target.value.toLowerCase();""===t||t.startsWith("https://")||t.startsWith("data:image/png;base64,")||t.startsWith("data:image/jpeg;base64,")||t.startsWith("data:image/gif;base64,")?n.setState({imageLink:e.target.value,isImageLinkValid:!0}):n.setState({isImageLinkValid:!1,isImageLinkPresent:!0})},n.onLocationChange=function(e){n.setState({location:e,isLocationPresent:!0})},n.onSearchEnableChange=function(e){n.setState({searchEnabled:!e})},n.onProfileMatchEnableChange=function(e){n.setState({isProfileMatchingEnabled:!e})},n.getRequiredFieldError=function(e){return e?Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{"data-testid":"empty_validation",content:n.localize("RequiredFieldMessage"),error:!0,size:"small"})},n.getInvalidUrlError=function(e){return e?Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{"data-testid":"url_validation",content:n.localize("InvalidUrlMessage"),error:!0,size:"small"})},n.localize=n.props.t,n.state={loading:!0,theme:"",tagsList:[],tag:"",tagValidation:{isEmpty:!1,isExisting:!1,isLengthValid:!0,isTagsCountValid:!0,containsSemicolon:!1},groupId:"",groupType:"",groupName:"",groupDescription:"",groupLink:"",teamName:"",teamDescription:"",teamLink:"",imageLink:"",location:"",searchEnabled:!1,isGroupTypePresent:!0,isGroupNamePresent:!0,isGroupDescriptionPresent:!0,isGroupLinkPresent:!0,isGroupLinkValid:!0,isTeamNamePresent:!0,isTeamDescriptionPresent:!0,isTeamLinkPresent:!0,isImageLinkPresent:!0,isLocationPresent:!0,isTeamLinkValid:!0,isImageLinkValid:!0,isExternalSelected:!1,isTeamsSelected:!1,errorMessage:"",submitLoading:!1,profileMatchFrequency:"",frequency:"",isProfileMatchingEnabled:!0,isFrequencyTypeMonthly:!0},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(D.a)(M.a.mark((function e(){var t,a,s=this;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m.initialize(),m.getContext((function(e){s.userObjectId=e.userObjectId,s.setState({theme:e.theme})})),!("id"in(t=this.props.match.params))){e.next=8;break}return a=t.id,e.next=7,this.getResourceGroup(a);case 7:this.setState({loading:!1,groupId:a});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateEmployeeResourceGroup",value:function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xt(this.state.groupId,t);case 2:400!==(a=e.sent).status||a.data?200===a.status&&a.data&&(this.setState({submitLoading:!1,errorMessage:""}),t.includeInSearchResults=this.state.searchEnabled,m.tasks.submitTask()):this.setState({submitLoading:!1,errorMessage:this.localize("GroupAlreadyExists")});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loading?Object(s.jsx)(I.a,{}):Object(s.jsxs)("div",{className:"default"===this.state.theme?"backgroundcolor":"",children:[Object(s.jsxs)(L.a,{className:"tab-container",column:!0,children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_type_field",size:"small",content:this.localize("GroupType")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupTypePresent)})]}),Object(s.jsx)(Pe.a,{className:"between-space",fluid:!0,placeholder:this.localize("GroupTypePlaceHolder"),items:[this.localize("External"),this.localize("Teams")],value:this.state.groupType,onChange:this.onGroupTypeChange,"data-testid":"group_type_dropdown"}),this.state.isExternalSelected&&Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_name_field",size:"small",content:this.localize("GroupName")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupNamePresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthName,fluid:!0,placeholder:this.localize("GroupNamePlaceHolder"),value:this.state.groupName,onChange:function(t){return e.onGroupNameChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_description_field",size:"small",content:this.localize("GroupDescription")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupDescriptionPresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthDescription,fluid:!0,placeholder:this.localize("GroupDescriptionPlaceHolder"),value:this.state.groupDescription,onChange:function(t){return e.onGroupDescriptionChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"group_link_field",size:"small",content:this.localize("GroupLink")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isGroupLinkPresent)}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getInvalidUrlError(this.state.isGroupLinkValid)})]}),Object(s.jsx)(Gt.a,{className:"between-space",fluid:!0,placeholder:this.localize("GroupLinkPlaceHolder"),value:this.state.groupLink,onChange:this.onGroupLinkChange})]}),this.state.isTeamsSelected&&Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"team_link_field",size:"small",content:this.localize("TeamLink")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isTeamLinkPresent)}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getInvalidUrlError(this.state.isTeamLinkValid)})]}),Object(s.jsx)(Gt.a,{className:"between-space",fluid:!0,placeholder:this.localize("TeamLinkPlaceHolder"),value:this.state.teamLink,onChange:this.onTeamLinkChange}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"team_name_field",size:"small",content:this.localize("TeamName")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isTeamNamePresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthName,fluid:!0,placeholder:this.localize("TeamNamePlaceHolder"),value:this.state.teamName,onChange:function(t){return e.onTeamNameChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"team_description_field",size:"small",content:this.localize("TeamDescription")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isTeamDescriptionPresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthDescription,fluid:!0,placeholder:this.localize("TeamDescriptionPlaceHolder"),value:this.state.teamDescription,onChange:function(t){return e.onTeamDescriptionChange(t.target.value)}})]}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"image_link_field",size:"small",content:this.localize("ImageLink")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isImageLinkPresent)}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getInvalidUrlError(this.state.isImageLinkValid)})]}),Object(s.jsx)(Gt.a,{className:"between-space",fluid:!0,placeholder:this.localize("ImageLinkPlaceHolder"),value:this.state.imageLink,onChange:this.onImageLinkChange,"data-testid":"image_url"}),Object(s.jsxs)("div",{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"tags_field",size:"small",content:this.localize("Tags")}),Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)("div",{children:this.getTagError()})})]}),Object(s.jsx)(Gt.a,{className:"between-space",placeholder:this.localize("TagsPlaceHolder"),fluid:!0,value:this.state.tag,onKeyDown:this.onTagKeyUp,onChange:function(t){return e.onTagChange(t.target.value)}}),Object(s.jsx)(L.a,{children:Object(s.jsx)("div",{children:this.state.tagsList.map((function(t,a){if(t.trim().length>0)return Object(s.jsx)(It.a,{circular:!0,className:"default"===e.state.theme?"tags-label-wrapper":"tags-label-wrapper-dark",content:Object(s.jsx)(b.a,{content:t.trim(),title:t.trim(),size:"medium"}),icon:Object(s.jsx)(N.a,{outline:!0,onClick:function(){return e.onTagRemoveClick(a)}},a)})}))})})]}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"location_field",size:"small",content:this.localize("Location")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isLocationPresent)})]}),Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.stateLocationMaxLength,fluid:!0,placeholder:this.localize("LocationPlaceHolder"),value:this.state.location,onChange:function(t){return e.onLocationChange(t.target.value)}}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"searchenabled_field",className:"margin-space",content:this.localize("SearchEnabled")}),Object(s.jsx)($t.a,{outline:!0,xSpacing:"after",title:this.localize("TagInfo"),size:"small"}),Object(s.jsx)(ot.b,{toggle:!0,checked:this.state.searchEnabled,onChange:function(){return e.onSearchEnableChange(e.state.searchEnabled)}})]}),this.state.groupType===Qe.teams&&Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"searchenabled_field",className:"margin-space",content:this.localize("ProfileMatching")}),Object(s.jsx)($t.a,{outline:!0,xSpacing:"after",title:this.localize("TagInfo"),size:"small"}),Object(s.jsx)(ot.b,{toggle:!0,checked:this.state.isProfileMatchingEnabled,onChange:function(){return e.onProfileMatchEnableChange(e.state.isProfileMatchingEnabled)}})]}),Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{"data-testid":"searchenabled_field",className:"margin-space",content:this.localize("MatchFrequency")}),Object(s.jsx)(Pe.a,{"aria-readonly":!0,disabled:!this.state.isProfileMatchingEnabled,items:[this.localize("EveryWeek"),this.localize("EveryMonth")],value:this.state.frequency,onChange:this.onFrequencyTypeChange,fluid:!0})]})]})]}),Object(s.jsxs)(L.a,{className:"tab-footer",hAlign:"end",children:[Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)(b.a,{className:"error-info",content:this.state.errorMessage,error:!0,size:"medium"})}),Object(s.jsx)(Ne.a,{primary:!0,content:this.localize("SubmitText"),onClick:this.handleSubmit,disabled:this.state.submitLoading,loading:this.state.submitLoading,"data-testid":"submit_button"})]})]})}}]),a}(n.Component),ta=Object(f.a)()(ea),aa=x()+"/api",sa=function(){var e=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=aa+"/knowledgebase",e.next=3,H.get(t,!1);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),na=function(){var e=Object(D.a)(M.a.mark((function e(t){var a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=aa+"/knowledgebase",e.next=3,H.patch(a,t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ra=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).localize=void 0,n.getKnowledgeBaseDetails=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,sa();case 3:200===(t=e.sent).status&&t.data&&n.setState({knowledgeBaseId:t.data,loading:!1}),e.next=14;break;case 7:if(e.prev=7,e.t0=e.catch(0),404!==e.t0.response.status){e.next=13;break}n.setState({loading:!1}),e.next=14;break;case 13:throw e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.handleSubmit=Object(D.a)(M.a.mark((function e(){var t;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.state.knowledgeBaseId){e.next=3;break}return n.setState({isKnowledgeBaseIdPresent:!1}),e.abrupt("return");case 3:return n.setState({submitLoading:!0}),t={id:n.state.knowledgeBaseId},e.next=7,na(t);case 7:m.tasks.submitTask();case 8:case"end":return e.stop()}}),e)}))),n.onKnowledgeBaseInputChange=function(e){n.setState({knowledgeBaseId:e,isKnowledgeBaseIdPresent:!0})},n.getRequiredFieldError=function(e){return e?Object(s.jsx)(s.Fragment,{}):Object(s.jsx)(b.a,{content:n.localize("RequiredFieldMessage"),error:!0,size:"small"})},n.localize=n.props.t,n.state={loading:!0,theme:"",knowledgeBaseId:"",isKnowledgeBaseIdPresent:!0,submitLoading:!1},n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=Object(D.a)(M.a.mark((function e(){var t=this;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return m.initialize(),m.getContext((function(e){t.setState({theme:e.theme})})),e.next=4,this.getKnowledgeBaseDetails();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return this.state.loading?Object(s.jsx)(I.a,{}):Object(s.jsx)("div",{className:"default"===this.state.theme?"backgroundcolor":"",children:Object(s.jsxs)(L.a,{className:"module-container",column:!0,children:[Object(s.jsxs)(L.a,{className:"top-padding",children:[Object(s.jsx)(b.a,{size:"small",content:this.localize("QnAMakerTitleText")}),Object(s.jsx)(L.a.Item,{push:!0,children:this.getRequiredFieldError(this.state.isKnowledgeBaseIdPresent)})]}),Object(s.jsx)(L.a,{children:Object(s.jsx)(Gt.a,{className:"between-space",maxLength:O.maxLengthKnowledgeBaseId,fluid:!0,value:this.state.knowledgeBaseId,placeholder:this.localize("QnAMakerInputPlaceHolderText"),onChange:function(t){return e.onKnowledgeBaseInputChange(t.target.value)}})}),Object(s.jsx)(L.a.Item,{push:!0,children:Object(s.jsx)(L.a,{className:"knowledge-base-footer",hAlign:"end",children:Object(s.jsx)(Ne.a,{primary:!0,content:this.localize("SaveText"),onClick:this.handleSubmit,disabled:this.state.submitLoading,loading:this.state.submitLoading})})})]})})}}]),a}(r.a.Component),ia=Object(f.a)()(ra),ca=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var r;return Object(o.a)(this,a),(r=t.call(this,e)).setThemeComponent=function(){return"dark"===r.state.theme?Object(s.jsx)(et.a,{theme:tt.themes.teamsDark,children:Object(s.jsx)("div",{className:"darkContainer",children:r.getAppDom()})}):"contrast"===r.state.theme?Object(s.jsx)(et.a,{theme:tt.themes.teamsHighContrast,children:Object(s.jsx)("div",{className:"highContrastContainer",children:r.getAppDom()})}):Object(s.jsx)(et.a,{theme:tt.themes.teams,children:Object(s.jsx)("div",{className:"defaultContainer",children:r.getAppDom()})})},r.updateTheme=function(e){"dark"===e?r.setState({themeStyle:De.ThemeStyle.Dark}):"contrast"===e?r.setState({themeStyle:De.ThemeStyle.HighContrast}):r.setState({themeStyle:De.ThemeStyle.Light})},r.getAppDom=function(){var e=Object(De.getContext)({baseFontSize:10,style:r.state.themeStyle});return Object(s.jsx)(De.TeamsThemeContext.Provider,{value:e,children:Object(s.jsx)(n.Suspense,{fallback:Object(s.jsx)("div",{}),children:Object(s.jsx)("div",{className:"appContainer",children:Object(s.jsx)(p.a,{children:Object(s.jsxs)(h.c,{children:[Object(s.jsx)(h.a,{exact:!0,path:"/configtab",component:k}),Object(s.jsx)(h.a,{exact:!0,path:"/messages",component:Me}),Object(s.jsx)(h.a,{exact:!0,path:"/createNewGroup",component:Zt}),Object(s.jsx)(h.a,{exact:!0,path:"/discover",component:Xt}),Object(s.jsx)(h.a,{exact:!0,path:"/newmessage",component:Xe}),Object(s.jsx)(h.a,{exact:!0,path:"/newmessage/:id",component:Xe}),Object(s.jsx)(h.a,{exact:!0,path:"/viewstatus/:id",component:Ze}),Object(s.jsx)(h.a,{exact:!0,path:"/sendconfirmation/:id",component:st}),Object(s.jsx)(h.a,{exact:!0,path:"/errorpage",component:rt}),Object(s.jsx)(h.a,{exact:!0,path:"/errorpage/:id",component:rt}),Object(s.jsx)(h.a,{exact:!0,path:"/signin",component:it}),Object(s.jsx)(h.a,{exact:!0,path:"/signin-simple-start",component:ct}),Object(s.jsx)(h.a,{exact:!0,path:"/signin-simple-end",component:Tt}),Object(s.jsx)(h.a,{exact:!0,path:"/configurationTab",component:yt}),Object(s.jsx)(h.a,{exact:!0,path:"/updateerg/:id",component:ta}),Object(s.jsx)(h.a,{exact:!0,path:"/updateKnowledgeBaseId",component:ia})]})})})})})},r.state={theme:"",themeStyle:De.ThemeStyle.Light},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;m.initialize(),m.getContext((function(t){var a=t.theme||"";e.updateTheme(a),e.setState({theme:a})})),m.registerOnThemeChangeHandler((function(t){e.updateTheme(t),e.setState({theme:t},(function(){e.forceUpdate()}))})),function(){var e=window.location.search,t=new URLSearchParams(e).get("locale")||"en-US";G.a.changeLanguage(t),R.a.locale(t)}()}},{key:"render",value:function(){return Object(s.jsx)("div",{children:this.setThemeComponent()})}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var oa=a(145),la=Object(oa.c)({messagesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"FETCH_MESSAGES"===t.type?t.payload:e},draftMessagesList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return"FETCH_DRAFTMESSAGES"===t.type?t.payload:e},selectedMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return"MESSAGE_SELECTED"===t.type?t.payload:e}}),ua=a(451),da=Object(oa.d)(la,Object(oa.a)(ua.a));c.a.render(Object(s.jsx)(y.a,{store:da,children:Object(s.jsx)(ca,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[711,1,2]]]);
//# sourceMappingURL=main.540b12d1.chunk.js.map